import{S as t}from"./sse.js-610fcddf.js";import{h as e,l as a}from"../index-1be2c002.js";const r=t=>{if("public"===a){const e={historyContextItem:{contextId:t.contextId,title:"",lastUpdateTime:Date.now()},chatContextDto:t};for(let s=0;s<t.messages.length;s++){const a=t.messages[s];if("user"===a.role){e.historyContextItem.title=a.content.length>64?a.content.substring(0,64):a.content;break}}let a=localStorage.getItem("chatContext");const r=a?JSON.parse(a):{};r[t.contextId]=e,localStorage.setItem("chatContext",JSON.stringify(r))}return Promise.resolve()},s=e=>new t("/v1/rest/jrag/chat",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(e)}),o=()=>e.get("/v1/rest/jrag/api/check"),n=()=>e.get("/v1/rest/jrag/context/id"),c=(t,r)=>{if("public"===a){let t=localStorage.getItem("chatContext");const e=t?JSON.parse(t):{},a={data:Object.values(e).map((t=>t.historyContextItem))};return Promise.resolve({data:a})}return e.get("/v1/rest/jrag/context/list",{params:{offset:t,limit:r}})},i=t=>{if("public"===a){let e=localStorage.getItem("chatContext");const a=e?JSON.parse(e):{};return Promise.resolve({data:a[t]?.chatContextDto})}return e.get("/v1/rest/jrag/context",{params:{"context-id":t}})},l=t=>"user"===a?e.post("/v1/rest/jrag/context/message/feedback",t):Promise.resolve(),g=t=>{if("public"===a){let e=localStorage.getItem("chatContext");const a=e?JSON.parse(e):{};return Array.isArray(t)?t.forEach((t=>{delete a[t]})):delete a[t],localStorage.setItem("chatContext",JSON.stringify(a)),Promise.resolve()}return e.delete("/v1/rest/jrag/context",{params:{"context-id":Array.isArray(t)?t.join(","):t}})},m=t=>e.get("/v1/rest/jrag/qa-template",{params:{limit:t}}),p=t=>new WebSocket(window.location.origin.replace("http","ws")+"/ws/jrag/chat/alive?context-id="+t);export{s as a,m as b,o as c,g as d,n as e,i as f,c as g,l as h,p as o,r as s};
