System.register(["./sse.js-legacy-c6427e4c.js","../index-legacy-2dcc98d9.js"],(function(t){"use strict";var e,r,n;return{setters:[function(t){e=t.S},function(t){r=t.h,n=t.l}],execute:function(){var o="chatContext";t("s",(function(t){if("public"===n){for(var e={historyContextItem:{contextId:t.contextId,title:"",lastUpdateTime:Date.now()},chatContextDto:t},r=0;r<t.messages.length;r++){var a=t.messages[r];if("user"===a.role){e.historyContextItem.title=a.content.length>64?a.content.substring(0,64):a.content;break}}var s=localStorage.getItem(o),i=s?JSON.parse(s):{};i[t.contextId]=e,localStorage.setItem(o,JSON.stringify(i))}return Promise.resolve()})),t("a",(function(t){return new e("/v1/rest/jrag/chat",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(t)})})),t("c",(function(){return r.get("/v1/rest/jrag/api/check")})),t("b",(function(){return r.get("/v1/rest/jrag/context/id")})),t("g",(function(t,e){if("public"===n){var a=localStorage.getItem(o),s=a?JSON.parse(a):{},i={data:Object.values(s).map((function(t){return t.historyContextItem}))};return Promise.resolve({data:i})}return r.get("/v1/rest/jrag/context/list",{params:{offset:t,limit:e}})})),t("e",(function(t){if("public"===n){var e,a=localStorage.getItem(o),s=a?JSON.parse(a):{};return Promise.resolve({data:null===(e=s[t])||void 0===e?void 0:e.chatContextDto})}return r.get("/v1/rest/jrag/context",{params:{"context-id":t}})})),t("f",(function(t){return"user"===n?r.post("/v1/rest/jrag/context/message/feedback",t):Promise.resolve()})),t("d",(function(t){if("public"===n){var e=localStorage.getItem(o),a=e?JSON.parse(e):{};return Array.isArray(t)?t.forEach((function(t){delete a[t]})):delete a[t],localStorage.setItem(o,JSON.stringify(a)),Promise.resolve()}return r.delete("/v1/rest/jrag/context",{params:{"context-id":Array.isArray(t)?t.join(","):t}})})),t("o",(function(t){return new WebSocket(window.location.origin.replace("http","ws")+"/ws/jrag/chat/alive?context-id="+t)}))}}}));
