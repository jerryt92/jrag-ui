!function(){var e=document.createElement("style");e.innerHTML=".chat-manage-container[data-v-1cc54cc6]{width:400px;padding:64px 20px 20px;margin:auto;display:flex;height:100%;justify-content:center}.chat-manage-container .iconfont[data-v-1cc54cc6]{margin-right:5px}.chat-manage-container .chat-manage-card[data-v-1cc54cc6]{background-color:rgba(255,255,255,.5);backdrop-filter:blur(10px);display:flex;flex-direction:column;align-items:center;height:100%;flex-grow:1;padding:0 20px 20px;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,.1);position:relative;left:0;width:100%;max-width:360px;max-height:calc(100vh - 40px)}.chat-manage-container .chat-manage-header[data-v-1cc54cc6]{text-align:center;display:flex;flex-direction:row;justify-content:center;align-items:center;padding:20px 0;width:320px}.chat-manage-container .chat-manage-header .el-button[data-v-1cc54cc6]{height:40px}.chat-manage-container .chat-manage-header .el-button.add[data-v-1cc54cc6]{width:270px}.chat-manage-container .chat-manage-header .el-button.is-circle[data-v-1cc54cc6]{flex:1;width:40px;margin-left:10px}.chat-manage-container .chat-manage-header .el-input.search-input[data-v-1cc54cc6]{height:40px;width:100%}.chat-manage-container .chat-manage-header .el-input.search-input[data-v-1cc54cc6] .el-input__wrapper{border-radius:40px}.chat-manage-container .chat-list[data-v-1cc54cc6]{padding:10px 0 0;display:flex;flex-direction:column;justify-content:center;align-items:center;flex-grow:1;width:320px;overflow:auto}.chat-manage-container .chat-list .list-title[data-v-1cc54cc6]{justify-content:space-between;width:100%;margin-bottom:5px;padding-right:10px}.chat-manage-container .chat-list .list-title .delete[data-v-1cc54cc6]{color:var(--el-color-info);cursor:pointer}.chat-manage-container .chat-list .list-title .delete[data-v-1cc54cc6]:hover{color:var(--el-color-primary)}.chat-manage-container .chat-list .list-content[data-v-1cc54cc6]{width:100%;height:100%;overflow:auto;padding-right:10px}.chat-manage-container .chat-list .list-content .list-item[data-v-1cc54cc6]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;margin:15px 0;padding:0 15px;background-color:rgba(255,255,255,.9);border-radius:15px;height:45px;line-height:45px;cursor:pointer}.chat-manage-container .chat-list .list-content .list-item[data-v-1cc54cc6]:hover,.chat-manage-container .chat-list .list-content .list-item.active[data-v-1cc54cc6]{color:var(--el-color-primary);border-color:var(--el-color-primary);background-color:var(--el-color-primary-light-9)}.chat-manage-container .chat-list .list-content .list-item .cont[data-v-1cc54cc6]{width:calc(100% - 20px);flex-grow:1}.chat-manage-container .chat-list .list-content .list-item .cont p[data-v-1cc54cc6]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chat-manage-container .chat-list .list-content .list-item .el-dropdown[data-v-1cc54cc6]{z-index:999;width:20px;padding-left:10px}.chat-manage-container .chat-list .list-content .list-item .icon-vgengduo[data-v-1cc54cc6]:hover{color:var(--el-color-primary)}.chat-manage-container .chat-list .list-content .el-dropdown-link[data-v-1cc54cc6]{display:flex;align-items:center}.chat-container[data-v-7c835c7e]{height:100%;display:flex;flex-direction:column;position:relative}.chat-container.fullscreen[data-v-7c835c7e]{flex-direction:row}.chat-container.fullscreen .chat-manage-view[data-v-7c835c7e]{width:360px;max-width:360px;height:100%}.chat-container.fullscreen .chat-manage-view[data-v-7c835c7e] .chat-list{height:100%!important;max-height:100%!important}.chat-container.fullscreen .chat-view[data-v-7c835c7e]{flex-grow:1;width:100%}.chat-container .chat-view[data-v-7c835c7e]{display:flex;flex-direction:column;justify-content:center;height:100%;padding:calc(2 * var(--n-padding-basic))}.chat-container .chat-view .scroll[data-v-7c835c7e]{flex-grow:1;height:100%}.ai-logo[data-v-7c835c7e]{width:100px;margin:0 auto}.ai-logo img[data-v-7c835c7e]{width:100%;height:100%;object-fit:contain}.message-init[data-v-7c835c7e]{text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:44px;padding:20px 0}.message-init .title[data-v-7c835c7e]{font-size:20px;color:#333;margin-top:20px}.message-init .sub-tip[data-v-7c835c7e]{font-size:18px;color:#637a9e;line-height:1.5;display:block;margin:20px 0 30px}.message-init .hot-questions[data-v-7c835c7e]{display:flex;flex-direction:column;box-shadow:0 0 12px var(--el-color-primary-light-7);min-width:350px;max-width:450px;padding:20px;border-radius:15px;max-height:300px;min-height:160px;overflow:auto;background-color:#fff}.message-init .hot-questions .hot-questions-title[data-v-7c835c7e]{justify-content:space-between;margin-bottom:15px}.message-init .hot-questions .hot-questions-title strong .el-icon[data-v-7c835c7e]{margin-right:2px}.message-init .hot-questions .hot-questions-title .change[data-v-7c835c7e]{color:var(--n-color-neutral-5);cursor:pointer;display:flex;justify-content:center;align-items:center}.message-init .hot-questions .hot-questions-title .change[data-v-7c835c7e]:hover{color:var(--el-color-primary)}.message-init .hot-questions .question-list[data-v-7c835c7e]{display:flex;flex-direction:column;justify-content:center}.message-init .hot-questions .question-list .question[data-v-7c835c7e]{margin-bottom:15px;cursor:pointer;line-height:1.5;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.message-init .hot-questions .question-list .question[data-v-7c835c7e]:hover{color:var(--el-color-primary)}.message-init .hot-questions .question-list .question .qa[data-v-7c835c7e]{margin-right:10px;height:20px;line-height:20px;color:var(--el-color-primary);font-family:auto;font-style:italic;background-color:var(--el-color-primary-light-9);display:inline-block;padding:0 4px 0 2px;border-radius:15px}.message-init .hot-questions .question-list .question[data-v-7c835c7e]:last-child{margin-bottom:0}.message-list[data-v-7c835c7e]{padding:20px 0}.message-list .message-row[data-v-7c835c7e]{margin-bottom:20px;display:flex}.message-list .message-row .message-content[data-v-7c835c7e]{max-width:80%;padding:10px 15px;border-radius:15px;height:100%;min-height:48px;font-size:var(--n-font-size-2);word-wrap:break-word;word-break:break-all;justify-content:center;display:flex;flex-direction:column;transition:transform .2s ease}.message-list .message-row .message-content[data-v-7c835c7e]:hover{transform:translate(-3px,-3px);box-shadow:0 6px 8px rgba(0,0,0,.1)}.message-list .message-row .message-content[data-v-7c835c7e] img{max-width:100%;height:auto;display:block}.message-list .message-row.assistant .message-content[data-v-7c835c7e]{background-color:var(--el-color-primary-light-8);border:1px solid var(--el-color-primary-light-8)}.message-list .message-row.assistant .message-content .src-file[data-v-7c835c7e]{margin-top:15px;font-style:italic;font-size:var(--n-font-size-1)}.message-list .message-row.assistant .message-content .support[data-v-7c835c7e]{text-align:right;margin-top:10px}.message-list .message-row.assistant .message-content .support .iconfont[data-v-7c835c7e]{cursor:pointer}.message-list .message-row.assistant .message-content .support .iconfont[data-v-7c835c7e]:last-child{margin-right:0}.message-list .message-row.assistant .message-content .support .iconfont[data-v-7c835c7e]:hover,.message-list .message-row.assistant .message-content .support .iconfont.yes[data-v-7c835c7e],.message-list .message-row.assistant .message-content .support .iconfont.no[data-v-7c835c7e]{color:var(--el-color-primary)}.message-list .message-row.user[data-v-7c835c7e]{justify-content:flex-end}.message-list .message-row.user .message-content[data-v-7c835c7e]{background-color:#d8d8f6}.chat-model[data-v-7c835c7e]{padding-bottom:15px}.chat-model .el-button.active[data-v-7c835c7e]{color:var(--el-color-primary);border-color:var(--el-color-primary);background-color:var(--el-color-primary-light-9)}.chat-model .el-button img[data-v-7c835c7e]{height:16px;margin-right:5px}.input-area[data-v-7c835c7e]{box-shadow:0 0 12px var(--el-color-primary-light-7);overflow:visible;display:flex;padding:0;border-radius:15px;position:relative}.input-area .el-textarea.chat-input[data-v-7c835c7e] textarea{resize:none;background-color:rgba(255,255,255,.9);backdrop-filter:blur(10px);padding:15px 20px;border-radius:15px;word-wrap:break-word;word-break:break-all}.input-area .el-textarea.chat-input[data-v-7c835c7e] textarea :hover{box-shadow:none}.input-area .el-textarea.chat-input[data-v-7c835c7e] .el-input__count{right:60px;bottom:15px}.input-area .el-button[data-v-7c835c7e]{position:absolute;right:20px;bottom:15px}.thinking-indicator[data-v-7c835c7e]{margin-top:14px;margin-right:10px;display:inline-block;width:20px;height:20px;border:3px solid var(--el-color-primary-light-8);border-top-color:var(--el-color-primary);border-radius:50%;animation:thinking-7c835c7e 1s linear infinite;margin-left:10px;flex-shrink:0}.avatar-wrap[data-v-7c835c7e]{margin:0 10px}.avatar-wrap .el-avatar[data-v-7c835c7e]{margin:0;flex-shrink:0;width:50px;height:50px}.avatar-wrap .ai-chat-logo[data-v-7c835c7e]{background-color:#6c57f6;padding:8px 10px 12px}.avatar-wrap .ai-chat-logo img[data-v-7c835c7e]{width:100%;height:100%;object-fit:contain}.avatar-wrap.thinking-avatar[data-v-7c835c7e]{width:50px;height:50px;box-shadow:0 0 12px var(--el-color-primary);background:linear-gradient(#9724ff,#00c4ff);border-radius:50%;justify-content:center;display:flex;align-items:center;animation:thinking-7c835c7e 1s linear infinite}.avatar-wrap.thinking-avatar .el-avatar[data-v-7c835c7e]{width:42px;height:42px;animation:anti-thinking-7c835c7e 1s linear infinite}.avatar-wrap.thinking-avatar .ai-chat-logo[data-v-7c835c7e]{padding:7px 7px 10px}@keyframes thinking-7c835c7e{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes anti-thinking-7c835c7e{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}.message-content[data-v-7c835c7e] h1{font-size:var(--n-font-size-6);margin-bottom:calc(var(--n-font-size-6) / 2)}.message-content[data-v-7c835c7e] h2{font-size:var(--n-font-size-5);margin-bottom:calc(var(--n-font-size-5) / 2)}.message-content[data-v-7c835c7e] h3{font-size:var(--n-font-size-4);margin-bottom:calc(var(--n-font-size-4) / 2)}.message-content[data-v-7c835c7e] h4{font-size:var(--n-font-size-3);margin-bottom:calc(var(--n-font-size-3) / 2)}.message-content[data-v-7c835c7e] h5{font-size:var(--n-font-size-2);margin-bottom:calc(var(--n-font-size-2) / 2)}.message-content[data-v-7c835c7e] h6{font-size:var(--n-font-size-1);margin-bottom:calc(var(--n-font-size-1) / 2)}.message-content[data-v-7c835c7e] ol{list-style:none;padding-left:calc(3 * var(--n-font-size-2))}.message-content[data-v-7c835c7e] ol li{list-style:decimal}.message-content[data-v-7c835c7e] ul{padding-left:calc(3 * var(--n-font-size-2))}.message-content[data-v-7c835c7e] ul li{list-style:disc}.message-content[data-v-7c835c7e] a{color:#2b6afd;text-decoration:none}.message-content[data-v-7c835c7e] a:hover{text-decoration:underline}.message-content[data-v-7c835c7e] code{background-color:#d4d4d4;padding:3px;border-radius:4px;font-family:Courier New,Courier,monospace;white-space:pre-wrap;word-wrap:break-word}.message-content[data-v-7c835c7e] pre{background-color:#1e1e1e;color:#e0e0e0;padding:1em;margin:10px 0;border-radius:4px;overflow-x:auto;font-family:monospace}.message-content[data-v-7c835c7e] pre code{background-color:transparent;padding:0}.scroll-to-bottom-button[data-v-7c835c7e]{position:absolute;top:95%;left:50%;transform:translate(-50%,-50%);background-color:rgba(255,255,255,.7);backdrop-filter:blur(2px);border-radius:50%;padding:10px;box-shadow:0 2px 4px rgba(0,0,0,.1);cursor:pointer}@media only screen and (max-width: 768px){.message-init[data-v-7c835c7e]{padding:0 0 20px}}@media only screen and (max-width: 600px){.chat-input[data-v-7c835c7e]{height:70px!important}.chat-input[data-v-7c835c7e] textarea{height:70px!important;min-height:70px!important}.message-init[data-v-7c835c7e]{padding:0 0 20px}.message-init .ai-logo[data-v-7c835c7e]{width:80px}.message-init .title[data-v-7c835c7e]{font-size:18px}.message-init .sub-tip[data-v-7c835c7e]{font-size:16px}}.ai-assistant-page[data-v-4419d6b6]{background-image:url(assets/wallpaper.d62f7754.svg);background-repeat:repeat;background-size:auto;background-position:center;height:100%;position:relative}.ai-assistant-page .chat-view[data-v-4419d6b6]{width:100%}.ai-assistant-page .chat-menu[data-v-4419d6b6]{position:absolute;z-index:101;right:15px;top:50%;transform:translateY(-50%);font-size:24px;cursor:pointer;width:36px;height:36px;display:flex;align-items:center;justify-content:center;color:#666;border-radius:8px;transition:all .3s}.ai-assistant-page .chat-menu[data-v-4419d6b6]:hover{background-color:rgba(0,0,0,.05)}.ai-assistant-page .chat-menu.active[data-v-4419d6b6]{color:var(--el-color-primary);background-color:rgba(var(--el-color-primary-rgb),.1)}.ai-assistant-page .top-bar[data-v-4419d6b6]{position:fixed;top:0;left:0;right:0;height:44px;background-color:rgba(255,255,255,.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(0,0,0,.1);display:flex;align-items:center;justify-content:center;z-index:100}.ai-assistant-page .top-bar h3[data-v-4419d6b6]{margin:0;font-size:20px;font-weight:500;color:#333}\n",document.head.appendChild(e),System.register(["./@vue-legacy-ba50ba1c.js","./@element-plus-legacy-0c5c38e7.js","./markdown-it-legacy-c66ffae4.js","./sse.js-legacy-61adf886.js","../index-legacy-7ec55da3.js","./plugin-vue_export-helper-legacy-1285489a.js","./element-plus-legacy-d93f5902.js","./vue-router-legacy-0e719774.js","./lodash-es-legacy-6963f153.js","./mdurl-legacy-efdb6c67.js","./uc.micro-legacy-1b4c5267.js","./entities-legacy-bc6178f2.js","./linkify-it-legacy-5eba450c.js","./punycode.js-legacy-3c684dfd.js","./axios-legacy-ec40b469.js","./mitt-legacy-e809dc6d.js","./@popperjs-legacy-f5ef238f.js","./@vueuse-legacy-b8919453.js","./async-validator-legacy-9f2b928b.js","./@ctrl-legacy-93ea6807.js"],(function(e){"use strict";var t,a,n,i,o,c,r,s,l,d,u,g,v,p,h,f,m,x,y,w,b,k,j,C,z,A,q,T,P,E,H,L,I,M,S,F,N,U,_,B,O,R,Q;return{setters:[function(e){t=e.d,a=e.r,n=e.w,i=e.o,o=e.c,c=e.a,r=e.I,s=e.u,l=e.G,d=e.L,u=e.J,g=e.a2,v=e.O,p=e.R,h=e.S,f=e.ah,m=e.n,x=e.H,y=e.M,w=e.f,b=e.F,k=e.C,j=e.ai},function(e){C=e.f,z=e.e,A=e.p},function(e){q=e.M},function(e){T=e.S},function(e){P=e.h,E=e.t},function(e){H=e._},function(e){L=e.c,I=e.d,M=e.g,S=e.h,F=e.i,N=e.j,U=e.k,_=e.l,B=e.m,O=e.n},function(e){R=e.u},function(e){Q=e.j},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var G={class:"chat-manage-container"},J={class:"chat-manage-card"},W={class:"chat-manage-header"},V={class:"chat-list"},X={class:"list-title fx"},Y={class:"text"},Z={class:"list-content"},D=["onClick"],K={class:"cont fx"},$=t({__name:"chatManage",props:{newChat:{type:Function,required:!0,default:function(){}},historyChat:{type:Function,required:!0,default:function(){}},currContextId:{type:String,default:""},messageContext:{type:Array,default:function(){return[]}}},emits:["showChatManage"],setup:function(e,t){var w=t.expose,b=t.emit,k=e,j=a(),z=a(!1),A=a(""),q=a([]),T=a([]),H=a(k.currContextId),_=b;n((function(){return k.currContextId}),(function(e){H.value=e}));var B=function(){var e;_("showChatManage",!1),null!==(e=k.messageContext)&&void 0!==e&&e.length?(H.value="",k.newChat(),O()):M({message:E("ai.already.latest.chat"),type:"success"})},O=function(){var e,t;P.get("/v1/rest/jrag/context/list",{params:{offset:e,limit:t}}).then((function(e){q.value=e.data.data,Q(A.value,e.data.data)}))},R=function(e){var t=[];e?t.push(e):q.value.forEach((function(e){t.push(e.contextId)})),S.confirm(E("ai.delete.warning"),E(e?"ai.delete.chat.confirm":"ai.delete.all.chat.confirm"),{confirmButtonText:E("common.ok"),cancelButtonText:E("common.cancel"),type:"warning"}).then((function(){(function(e){return P.delete("/v1/rest/jrag/context",{params:{"context-id":Array.isArray(e)?e.join(","):e}})})(t).then((function(t){O(),e===H.value&&B()}))}))};n((function(){return A.value}),(function(e){Q(e)}));var Q=function(e,t){var a=new RegExp(e,"i"),n=t||q.value;T.value=n.filter((function(e){return a.test(e.title)}))};return w({getHistoryListData:O}),function(e,t){var a;return i(),o("div",G,[c("div",J,[c("div",W,[z.value?(i(),r(s(L),{key:0,ref_key:"searchInputRef",ref:j,modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return A.value=e}),class:"search-input",placeholder:e.$t("ai.search.history.context"),"suffix-icon":s(C),autofocus:"",onBlur:t[1]||(t[1]=function(e){return z.value=!1})},null,8,["modelValue","placeholder","suffix-icon"])):(i(),o(l,{key:1},[d(s(I),{type:"primary",class:"add",round:"",onClick:B},{default:u((function(){return[t[4]||(t[4]=c("i",{class:"iconfont icon-chat-new"},null,-1)),g(v(e.$t("ai.add.new.chat")),1)]})),_:1,__:[4]}),d(s(I),{icon:s(C),circle:"",onClick:t[2]||(t[2]=function(e){return z.value=!0,void m((function(){A.value="",j.value.focus()}))})},null,8,["icon"])],64))]),p(c("div",V,[c("div",X,[c("div",Y,v(e.$t("ai.history.chat")),1),c("div",{class:"delete",onClick:t[3]||(t[3]=function(e){return R()})},[t[5]||(t[5]=c("i",{class:"iconfont icon-trash-alt"},null,-1)),g(v(e.$t("ai.delete.all.chat")),1)])]),c("div",Z,[(i(!0),o(l,null,f(T.value,(function(e,a){return i(),o("div",{key:a,class:x(["list-item fx",{active:H.value===e.contextId}]),onClick:function(t){return a=e.contextId,_("showChatManage",!1),H.value=a,k.historyChat(a),void(A.value="");var a}},[c("div",K,[t[6]||(t[6]=c("i",{class:"iconfont icon-lishiduihua"},null,-1)),c("p",null,v(e.title),1)]),d(s(U),{trigger:"hover",teleported:!1},{dropdown:u((function(){return[d(s(F),null,{default:u((function(){return[d(s(N),{onClick:y((function(t){return R(e.contextId)}),["stop"])},{default:u((function(){return[t[7]||(t[7]=c("i",{class:"iconfont icon-trash-alt"},null,-1)),g(" "+v(s(E)("common.delete")),1)]})),_:2,__:[7]},1032,["onClick"])]})),_:2},1024)]})),default:u((function(){return[t[8]||(t[8]=c("span",{class:"el-dropdown-link"},[c("span",{class:"iconfont icon-vgengduo"},"...")],-1))]})),_:2,__:[8]},1024)],10,D)})),128))])],512),[[h,null===(a=T.value)||void 0===a?void 0:a.length]])])])}}}),ee=H($,[["__scopeId","data-v-1cc54cc6"]]),te=function(e){return e&&0!==e.length?e.map((function(e){return"- [".concat(e.fullFileName,"](").concat(e.url,")")})).join("\n"):""},ae={key:0,class:"chat-view"},ne={class:"message-init"},ie={class:"title"},oe={key:0,class:"message-list"},ce={class:"message-content"},re=["innerHTML"],se={class:"src-file"},le=["innerHTML"],de={class:"support"},ue=["onClick"],ge=["onClick"],ve=["innerHTML"],pe={class:"avatar-wrap"},he={class:"input-area"},fe=t({__name:"ChatView",props:{isFullscreen:{type:Boolean,default:!1},isMobile:{type:Boolean,default:!1}},setup:function(e,t){var n=t.expose,r=new q({html:!0,linkify:!0,typographer:!0});r.renderer.rules.paragraph_open=function(e,t){return'<p style="line-height: var(--n-font-line-height-4);">'},r.renderer.rules.link_open=function(e,t,a,n,i){return e[t].attrPush(["target","_blank"]),i.renderToken(e,t,a)};var g,y=a(!1),k=a(null),j=a(),C=a(),H=a(!0),F=a([]),N=a(""),U=a(!1),R=a(!0),Q=function(e){if(U.value)M.info(E("ai.assistant.waiting"));else if(e&&(N.value=e),N.value.trim()){U.value=!0,J();var t={index:F.value.length,content:N.value,role:"user"};F.value.push(t),N.value="";var a={contextId:j.value,messages:F.value};g=function(e){return new T("/v1/rest/jrag/chat",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(e)})}(a),g.onopen=function(){R.value&&(F.value.push({index:F.value.length,role:"assistant",content:""}),R.value=!1),J()},g.onmessage=function(e){try{var t=JSON.parse(e.data);G(t)}catch(a){}},g.onerror=function(e){401===e.responseCode?window.location.assign("/#/login"):0!==e.responseCode&&(M.error(E("ai.assistant.service.unavailable")),U.value=!1,R.value=!0)}}},G=function(e){var t,a;W(),H.value&&J(),"system"===(null===(t=e.message)||void 0===t?void 0:t.role)?(F.value[F.value.length-1]=e.message,F.value.push({index:F.value.length,role:"assistant",content:""})):"assistant"===(null===(a=e.message)||void 0===a?void 0:a.role)&&(F.value[F.value.length-1].index,e.message.index,!0===e.done?(F.value[F.value.length-1].content+=e.message.content,U.value=!1,R.value=!0,m((function(){g.close()}))):(e.message.srcFile&&(F.value[F.value.length-1].srcFile=e.message.srcFile),e.message.content&&(F.value[F.value.length-1].content+=e.message.content)))},J=function(){m((function(){C.value&&C.value.wrapRef.scrollTo({top:C.value.wrapRef.scrollHeight,behavior:"smooth"})}))},W=function(){if(C.value){var e=C.value.wrapRef,t=e.scrollTop,a=e.scrollHeight,n=e.clientHeight;H.value=t+100>a-n}},V=!0,X=function(e){"Enter"!==e.key||e.shiftKey||(V=!0,e.preventDefault())},Y=function(){V=!1},Z=function(){V&&(V=!1,Q())},D=function(e,t){var a;t.feedback=e,(a={contextId:j.value,index:t.index,feedback:e},P.post("/v1/rest/jrag/context/message/feedback",a)).then((function(t){1===e&&M({message:"😊",type:"info"}),2===e&&M({message:"😭",type:"info"})}))},K=function(){fe(),N.value="",F.value=[],H.value=!0,P.get("/v1/rest/jrag/context/id").then((function(e){j.value=e.data.contextId})),J()},$=function(e){fe(),N.value="",e!==j.value&&k.value.getHistoryListData(),j.value=e,function(e){return P.get("/v1/rest/jrag/context",{params:{"context-id":e}})}(e).then((function(e){F.value=e.data.messages,J()}))},fe=function(){U.value=!1,R.value=!0,g&&g.close()};return w((function(){P.get("/v1/rest/jrag/ap-center/api/check").then((function(e){2===e.status?S.alert(E("ai.api.key.invalid"),{type:"error",message:E("ai.api.key.invalid.desc"),callback:function(){}}):K()}))})),n({showChatManage:y,chatManageRef:k,getHistoryListData:function(){return k.value.getHistoryListData()},newChat:K}),function(t,a){var n;return i(),o("div",{class:x(["chat-container",{fullscreen:e.isFullscreen,"is-mobile":e.isMobile}])},[p(d(ee,{class:"chat-manage",ref_key:"chatManageRef",ref:k,"new-chat":K,"history-chat":$,"curr-context-id":j.value,"message-context":F.value,onShowChatManage:a[0]||(a[0]=function(e){return y.value=e})},null,8,["curr-context-id","message-context"]),[[h,y.value||e.isFullscreen]]),!y.value||e.isFullscreen||e.isMobile&&!y.value?(i(),o("div",ae,[d(s(B),{ref_key:"scrollbarRef",ref:C,class:"scroll",onScroll:W},{default:u((function(){var e;return[c("div",ne,[a[3]||(a[3]=c("div",{class:"ai-logo"},[c("span",{style:{"font-size":"100px"}},"🤖")],-1)),c("h2",ie,v(t.$t("ai.hi.assistant")),1)]),null!==(e=F.value)&&void 0!==e&&e.length?(i(),o("div",oe,[(i(!0),o(l,null,f(F.value,(function(e,n){return i(),o("div",{key:n,class:x(["message-row",[e.role]])},["assistant"===e.role?(i(),o(l,{key:0},[c("div",{class:x(["avatar-wrap",[U.value&&n===F.value.length-1?"thinking-avatar":""]])},[d(s(O),{size:50,class:"ai-chat-logo"},{default:u((function(){return a[4]||(a[4]=[c("span",{style:{"font-size":"35px",margin:"auto"}},"🤖",-1)])})),_:1,__:[4]})],2),c("div",ce,[c("div",{innerHTML:s(r).render(e.content+(U.value&&n===F.value.length-1?"...":""))},null,8,re),p(c("div",se,[a[5]||(a[5]=c("br",null,null,-1)),c("p",null,v(t.$t("ai.source")),1),c("div",{innerHTML:s(r).render(s(te)(e.srcFile))},null,8,le)],512),[[h,e.srcFile&&e.srcFile.length>0]]),p(c("div",de,[c("span",{class:x(["iconfont",{yes:1===e.feedback}]),onClick:function(t){return D(1,e)}},"👍",10,ue),c("span",{class:x(["iconfont",{no:2===e.feedback}]),onClick:function(t){return D(2,e)}},"👎",10,ge)],512),[[h,(null==e?void 0:e.content)&&!U.value]])])],64)):"user"===e.role?(i(),o(l,{key:1},[c("div",{class:"message-content",innerHTML:s(r).render(e.content)},null,8,ve),c("div",pe,[d(s(O),{size:50},{default:u((function(){return a[6]||(a[6]=[c("img",{src:"data:image/png;base64,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"},null,-1)])})),_:1,__:[6]})])],64)):b("",!0)],2)})),128))])):b("",!0),H.value?b("",!0):(i(),o("div",{key:1,class:"scroll-to-bottom-button",onClick:J},[d(s(_),null,{default:u((function(){return[d(s(z))]})),_:1})]))]})),_:1},512),a[7]||(a[7]=c("div",{class:"chat-model"},null,-1)),c("div",he,[d(s(L),{modelValue:N.value,"onUpdate:modelValue":a[1]||(a[1]=function(e){return N.value=e}),class:"chat-input",placeholder:s(E)("ai.input.placeholder"),type:"textarea",autosize:{minRows:5,maxRows:10},maxlength:4e3,"show-word-limit":"",onKeydown:X,onInput:Y,onKeyup:Z},null,8,["modelValue","placeholder"]),d(s(I),{type:"primary",class:"chat-button",icon:s(A),circle:"",disabled:!(null!==(n=N.value)&&void 0!==n&&n.length),onClick:a[2]||(a[2]=function(e){return Q()})},null,8,["icon","disabled"])])])):b("",!0)],2)}}}),me=H(fe,[["__scopeId","data-v-7c835c7e"]]),xe={class:"top-bar"},ye=t({__name:"AIAssistantPage",setup:function(e){var t=R(),n=a(null),r=a(!0),s=a(!1),l=function(){n.value.showChatManage=!n.value.showChatManage,n.value.showChatManage&&m((function(){var e;null===(e=n.value.chatManageRef)||void 0===e||e.getHistoryListData()}))},u=function(){var e;(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<768||null!==(e=t.query)&&void 0!==e&&e.isMobile?(s.value=!0,r.value=!1,document.body.style.minWidth="0px"):(s.value=!1,r.value=!0,document.body.style.minWidth="768px")},v=function(){if(s.value){var e=document.querySelector(".web-app");e&&(e.style.height=window.innerHeight+"px")}else{var t=document.querySelector(".web-app");t&&(t.style.height="")}};return w((function(){u(),v(),s.value?v():m((function(){n.value.getHistoryListData()})),window.addEventListener("resize",Q((function(){u(),v()}),10)),window.addEventListener("orientationchange",(function(){setTimeout((function(){v()}),100)}))})),k((function(){window.removeEventListener("resize",u),window.removeEventListener("orientationchange",v)})),function(e,t){var a,u=j("draggable");return i(),o("div",{class:x(["ai-assistant-page",{"full-page":r.value,"mobile-page":s.value}])},[c("div",xe,[t[1]||(t[1]=c("h3",null,"Jrag",-1)),p((i(),o("span",{class:x(["chat-menu",{active:null===(a=n.value)||void 0===a?void 0:a.showChatManage}]),onClick:l},t[0]||(t[0]=[g(" ⌥ ",-1)]),2)),[[h,s.value],[u,{device:"mobile"}]])]),d(me,{ref_key:"chatViewRef",ref:n,class:"chat-view","is-fullscreen":r.value,"is-mobile":s.value},null,8,["is-fullscreen","is-mobile"])],2)}}});e("default",H(ye,[["__scopeId","data-v-4419d6b6"]]))}}}))}();
