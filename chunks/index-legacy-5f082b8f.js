!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return l(s,"_invoke",function(n,r,a){var o,i,l,c=0,s=a||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,p.n=n,u}};function f(n,r){for(i=n,l=r,t=0;!d&&c&&!a&&t<s.length;t++){var a,o=s[t],f=p.p,v=o[2];n>3?(a=v===r)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(i=0,p.v=r,p.n=o[1]):f<v&&(a=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,p.n=v,i=0))}if(a||n>1)return u;throw d=!0,r}return function(a,s,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,v),i=s,l=v;(t=i<2?e:l)||!d;){o||(i?i<3?(i>1&&(p.n=-1),f(i,l)):p.n=l:p.v=l);try{if(c=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(d=p.n<0)?l:n.call(r,p))!==u)break}catch(t){o=e,i=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,a,o),!0),s}var u={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),f=d.prototype=c.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=d,l(f,"constructor",d),l(d,"constructor",s),s.displayName="GeneratorFunction",l(d,a,"GeneratorFunction"),l(f),l(f,a,"Generator"),l(f,r,(function(){return this})),l(f,"toString",(function(){return"[object Generator]"})),(i=function(){return{w:o,m:v}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){function o(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},l(e,t,n,r)}function u(e,t,n,r,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,l,"next",e)}function l(e){u(o,r,a,i,l,"throw",e)}i(void 0)}))}}var s=document.createElement("style");s.innerHTML=".kb-table-container[data-v-6e5e5748]{font-family:Arial,sans-serif;padding:20px;height:100%;min-width:800px;display:flex;flex-direction:column;box-sizing:border-box;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.kb-table-container .header-actions[data-v-6e5e5748]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-shrink:0}.kb-table-container .header-actions .search-area[data-v-6e5e5748],.kb-table-container .header-actions .btn-area[data-v-6e5e5748]{display:flex;gap:10px}.kb-table-container .table-wrapper[data-v-6e5e5748]{border-radius:var(--n-radius-triple);flex:1;overflow:hidden}.kb-table-container .table-wrapper[data-v-6e5e5748] .el-table{height:100%!important}.kb-table-container .pagination-wrapper[data-v-6e5e5748]{margin-top:16px;display:flex;justify-content:flex-end;flex-shrink:0}.kb-table-container .text-chunk-preview[data-v-6e5e5748],.kb-table-container .outline-preview[data-v-6e5e5748]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;color:var(--el-color-primary)}.kb-table-container .text-chunk-full[data-v-6e5e5748],.kb-table-container .outline-full[data-v-6e5e5748]{max-height:300px;overflow-y:auto}.hit-test-container[data-v-dceb1c4e]{font-family:Arial,sans-serif;height:100%}.hit-test-container .header-with-tooltip[data-v-dceb1c4e]{display:flex;align-items:center;gap:4px}.hit-test-container .hit-test-result[data-v-dceb1c4e]{padding:20px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple);min-height:300px;height:calc(100% - 255px)}.hit-test-container .hit-test-result .table-wrapper[data-v-dceb1c4e]{height:100%;border-radius:var(--n-radius-triple);flex:1;overflow:hidden}.hit-test-container .hit-test-result .table-wrapper[data-v-dceb1c4e] .el-table{height:100%!important}.hit-test-container .hit-test-result .text-chunk-preview[data-v-dceb1c4e],.hit-test-container .hit-test-result .outline-preview[data-v-dceb1c4e]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;color:var(--el-color-primary)}.hit-test-container .hit-test-form[data-v-dceb1c4e]{height:235px;margin-top:20px;padding:20px;display:flex;flex-direction:column;box-sizing:border-box;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.hit-test-container .hit-test-form[data-v-dceb1c4e] .el-form-item__label{color:var(--n-color-font-dark);justify-content:flex-start}.hit-test-container .hit-test-form .top-k-input[data-v-dceb1c4e]{width:100px;margin-right:10px}.hit-test-container .hit-test-form .top-k-input[data-v-dceb1c4e] .el-form-item{margin-bottom:20px}.hit-test-container .hit-test-form .top-k-input[data-v-dceb1c4e] .el-input__wrapper{height:40px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%)}.hit-test-container .hit-test-form .top-k-input[data-v-dceb1c4e] .el-input-number{width:100%}.hit-test-container .hit-test-form .top-k-input[data-v-dceb1c4e] .el-input-number .el-input__inner{text-align:left}.hit-test-container .hit-test-form .input-area .el-textarea[data-v-dceb1c4e]{margin-bottom:5px}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-dceb1c4e] .el-input__count{right:80px;bottom:15px;background:rgba(255,255,255,0)}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-dceb1c4e] .el-textarea__inner{background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);padding:15px 20px;border-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);word-wrap:break-word;word-break:break-all;box-shadow:none}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-dceb1c4e] :hover{box-shadow:0 0 12px color-mix(in srgb,var(--el-color-primary-light-3),transparent 10%)}.hit-test-container .hit-test-form .input-area .el-button[data-v-dceb1c4e]{position:absolute;right:10px;bottom:30px}.rag-settings-page[data-v-26bd28c5]{padding:20px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.rag-settings-page .section-title[data-v-26bd28c5]{margin-bottom:12px;font-weight:600;color:var(--n-color-font-dark)}.rag-settings-page .settings-select[data-v-26bd28c5]{width:240px}.rag-settings-page .rag-weight-slider[data-v-26bd28c5]{width:320px}.rag-settings-page .rag-weight-slider .rag-weight-values[data-v-26bd28c5]{display:flex;justify-content:space-between;margin-top:6px;color:var(--n-color-neutral-6);font-size:12px}.rag-settings-page .settings-actions[data-v-26bd28c5]{display:flex;justify-content:flex-end;margin-top:10px}.layout-container[data-v-e012f15a]{display:flex;flex-direction:column;height:100vh;overflow:hidden}.layout-container .content-wrapper[data-v-e012f15a]{display:flex;flex:1;overflow:hidden}.layout-container .content-wrapper[data-v-e012f15a] .el-menu{padding-top:60px;border-right:none;height:100%;background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);border-right:1px solid rgba(255,255,255,.18);box-shadow:0 8px 32px rgba(31,38,135,.1)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item{border-radius:8px;margin:5px 10px;transition:all .3s;color:var(--n-color-font-dark)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item.is-active,.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item:hover{background-color:var(--el-color-primary);color:var(--n-color-neutral-w)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu--collapse .el-menu-item{margin:5px}.layout-container .content-wrapper .main-content[data-v-e012f15a]{padding-top:50px;flex:1;display:flex;flex-direction:column;overflow:hidden}.layout-container .content-wrapper .main-content .content-area[data-v-e012f15a]{flex:1;overflow:auto;padding:20px}.layout-container .content-wrapper .main-content .content-area .placeholder[data-v-e012f15a]{display:flex;justify-content:center;align-items:center;height:100%;font-size:18px;color:#999}\n",document.head.appendChild(s),System.register(["../index-legacy-cb9b3a41.js","./@vue-legacy-799a045e.js","./oem-legacy-aacc897f.js","./plugin-vue_export-helper-legacy-1285489a.js","./element-plus-legacy-99ea3658.js","./topoBar-legacy-efba15fc.js","./@element-plus-legacy-931e6d36.js","./property.api-legacy-79b728ba.js"],(function(e,n){"use strict";var r,o,l,u,s,d,p,f,v,b,m,h,g,w,y,x,k,_,E,S,T,j,O,V,C,R,P,I,M,K,W,N,A,U,z,D,F,G,B,H,q,L,X,Y,Q,$,J,Z,ee,te;return{setters:[function(e){r=e.h,o=e.t,l=e._},function(e){u=e.d,s=e.r,d=e.at,p=e.f,f=e.aa,v=e.o,b=e.c,m=e.a,h=e.X,g=e.M,w=e.a4,y=e.Q,x=e.u,k=e.al,_=e.U,E=e.A,S=e.K,T=e.ab,j=e.n,O=e.j,V=e.s,C=e.O},function(e){R=e.g,P=e.p},function(e){I=e._},function(e){M=e.f,K=e.d,W=e.p,N=e.q,A=e.r,U=e.s,z=e.i,D=e.a,F=e.t,G=e.m,B=e.c,H=e.u,q=e.g,L=e.v,X=e.w,Y=e.x,Q=e.y,$=e.A},function(e){J=e.T},function(e){Z=e.C},function(e){ee=e.g,te=e.p}],execute:function(){function ne(e){if(!e||isNaN(e))return"";var t=new Date(e),n=t.getMonth()+1;n<10&&(n="0"+n);var r=t.getDate();r<10&&(r="0"+r);var a=t.getHours();a<10&&(a="0"+a);var o=t.getMinutes();o<10&&(o="0"+o);var i=t.getSeconds();return i<10&&(i="0"+i),t.getFullYear()+"-"+n+"-"+r+" "+a+":"+o+":"+i}var re=function(e){return r.post("/v1".concat(R,"rest/").concat(P,"/knowledge/delete"),e)},ae=(e("p",(function(e){return r.put("/v1".concat(R,"rest/").concat(P,"/knowledge"),e)})),e("d",(function(){window.open("/v1".concat(R,"rest/").concat(P,"/knowledge/json-template"))})),e("i",(function(e){var t=new FormData;return t.append("jsonTemplate",e),r.post("/v1".concat(R,"rest/").concat(P,"/knowledge/json-template"),t)})),{class:"kb-table-container"}),oe={class:"header-actions"},ie={class:"btn-area"},le={class:"search-area"},ue={class:"table-wrapper"},ce={class:"outline-preview"},se={class:"outline-full"},de={class:"text-chunk-preview"},pe={class:"text-chunk-full"},fe={class:"pagination-wrapper"},ve=u({__name:"KnowledgeBaseList",setup:function(e){var u=s([]),O=s(!1),V=s(1),C=s(10),I=s(0),F=s(""),G=s([]),B=d((function(){return l((function(){return n.import("./KbAddDialog-legacy-1c94a334.js")}),void 0)})),H=d((function(){return l((function(){return n.import("./KbEditDialog-legacy-cf38d734.js")}),void 0)})),q=s(!1),L=s(!1),X=s(null),Y=function(){var e=c(i().m((function e(){var t,n,a;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return O.value=!0,e.p=1,e.n=2,o=(V.value-1)*C.value,i=C.value+1,l=F.value,r.get("/v1".concat(R,"rest/").concat(P,"/knowledge"),{params:{offset:o,limit:i,search:l}});case 2:n=e.v,(a=(null===(t=n.data)||void 0===t?void 0:t.data)||[]).length>C.value?(u.value=a.slice(0,C.value),I.value=(V.value+1)*C.value):(u.value=a,I.value=(V.value-1)*C.value+a.length),e.n=4;break;case 3:e.p=3,e.v,u.value=[],I.value=0;case 4:return e.p=4,O.value=!1,e.f(4);case 5:return e.a(2)}var o,i,l}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),Q=function(e){C.value=e,Y()},$=function(e){V.value=e,Y()},J=function(){V.value=1,Y()},Z=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,j();case 1:q.value=!0,e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){q.value=!1,Y()},te=function(){L.value=!1,Y()},ve=function(e){G.value=e},be=function(){0!==G.value.length&&z.confirm("ç¡®è®¤åˆ é™¤é€‰ä¸­çš„ ".concat(G.value.length," é¡¹æ•°æ®å—ï¼Ÿ"),"è­¦å‘Š",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(c(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return t=G.value.map((function(e){return e.textChunkId})),e.n=1,re(t);case 1:D.success("åˆ é™¤æˆåŠŸ"),Y();case 2:return e.a(2)}}),e)})))).catch((function(){}))};return p((function(){Y()})),function(e,n){var r=f("loading");return v(),b("div",ae,[m("div",oe,[m("div",ie,[h(x(M),{type:"primary",onClick:Y},{default:g((function(){return[w(y("ğŸ”„ "+x(o)("common.refresh")),1)]})),_:1}),h(x(M),{type:"primary",onClick:Z},{default:g((function(){return[w(y("â• "+x(o)("common.add")),1)]})),_:1}),h(x(M),{type:"danger",disabled:0===G.value.length,onClick:be},{default:g((function(){return[w(y("ğŸ—‘ï¸ "+x(o)("common.delete")),1)]})),_:1},8,["disabled"])]),m("div",le,[h(x(K),{modelValue:F.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return F.value=e}),placeholder:x(o)("common.search.placeholder.keyword"),clearable:"",style:{width:"240px"},onKeyup:k(J,["enter"]),onClear:J},null,8,["modelValue","placeholder"]),h(x(M),{type:"primary",onClick:J},{default:g((function(){return[w(y("ğŸ”ï¸ "+x(o)("common.search")),1)]})),_:1})])]),m("div",ue,[_((v(),E(x(A),{ref:"tableRef",data:u.value,style:{width:"100%",height:"100%"},border:"",onSelectionChange:ve},{default:g((function(){return[h(x(W),{type:"selection",width:"55",align:"center"}),h(x(W),{label:x(o)("kb.outline"),width:"300"},{default:g((function(e){return[h(x(N),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:g((function(){return[m("div",ce,y((t=e.row.outline,t&&0!==t.length?t.length<=3?t.join(" | "):"".concat(t.slice(0,3).join(", "),"... (+").concat(t.length-3,"é¡¹)"):"-")),1)];var t})),default:g((function(){return[m("div",se,[(v(!0),b(S,null,T(e.row.outline,(function(e,t){return v(),b("div",{key:t},y(t+1)+". "+y(e),1)})),128))])]})),_:2},1024)]})),_:1},8,["label"]),h(x(W),{label:x(o)("kb.textChunk"),width:"300"},{default:g((function(e){return[h(x(N),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:g((function(){return[m("div",de,y(e.row.textChunk),1)]})),default:g((function(){return[m("div",pe,y(e.row.textChunk),1)]})),_:2},1024)]})),_:1},8,["label"]),h(x(W),{prop:"description",label:x(o)("kb.description"),"min-width":"150","show-overflow-tooltip":""},null,8,["label"]),h(x(W),{prop:"dimension",label:x(o)("kb.dimension"),width:"130"},null,8,["label"]),h(x(W),{prop:"embeddingModel",label:x(o)("kb.embeddingModel"),width:"150"},null,8,["label"]),h(x(W),{prop:"embeddingProvider",label:x(o)("kb.embeddingProvider"),width:"150"},null,8,["label"]),h(x(W),{prop:"createTime",label:x(o)("common.create.time"),width:"180"},{default:g((function(e){return[w(y(x(ne)(e.row.createTime)),1)]})),_:1},8,["label"]),h(x(W),{prop:"updateTime",label:x(o)("common.update.time"),width:"180"},{default:g((function(e){return[w(y(x(ne)(e.row.updateTime)),1)]})),_:1},8,["label"]),h(x(W),{prop:"createUsername",label:x(o)("kb.create.username"),width:"150"},null,8,["label"]),h(x(W),{label:x(o)("common.action"),width:"120",align:"center",fixed:"right"},{default:g((function(e){return[h(x(M),{type:"primary",link:"",onClick:function(n){return r=e.row,X.value=a(a({},r),{},{outline:r.outline?t(r.outline):[]}),void(L.value=!0);var r}},{default:g((function(){return[w(y(x(o)("common.edit")),1)]})),_:1},8,["onClick"]),h(x(M),{type:"danger",link:"",onClick:function(t){var n;null!=(n=e.row)&&n.textChunkId&&z.confirm("ç¡®è®¤åˆ é™¤è¯¥æ¡æ•°æ®å—ï¼Ÿ","è­¦å‘Š",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(c(i().m((function e(){return i().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,re([n.textChunkId]);case 1:D.success("åˆ é™¤æˆåŠŸ"),Y();case 2:return e.a(2)}}),e)})))).catch((function(){}))}},{default:g((function(){return[w(y(x(o)("common.delete")),1)]})),_:1},8,["onClick"])]})),_:1},8,["label"])]})),_:1},8,["data"])),[[r,O.value]])]),m("div",fe,[h(x(U),{"current-page":V.value,"onUpdate:currentPage":n[1]||(n[1]=function(e){return V.value=e}),"page-size":C.value,"onUpdate:pageSize":n[2]||(n[2]=function(e){return C.value=e}),"page-sizes":[10,20,50,100],total:I.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Q,onCurrentChange:$},null,8,["current-page","page-size","total"])]),h(x(B),{modelValue:q.value,"onUpdate:modelValue":n[3]||(n[3]=function(e){return q.value=e}),onAddSuccess:ee},null,8,["modelValue"]),h(x(H),{modelValue:L.value,"onUpdate:modelValue":n[4]||(n[4]=function(e){return L.value=e}),knowledge:X.value,onEditSuccess:te},null,8,["modelValue","knowledge"])])}}}),be=I(ve,[["__scopeId","data-v-6e5e5748"]]),me={class:"hit-test-container"},he={class:"hit-test-result"},ge={class:"table-wrapper"},we={class:"outline-preview"},ye={class:"outline-full"},xe={class:"text-chunk-full"},ke={class:"header-with-tooltip"},_e={class:"text-chunk-preview"},Ee={class:"text-chunk-full"},Se={class:"hit-test-form"},Te=u({__name:"HitTest",setup:function(e){var n=s({text:"",topK:5}),a=s(),l=s(!1),u=s([]),d=function(e){return Number.isFinite(e)?e.toFixed(4):"-"},p=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.n){case 0:if(a.value){e.n=1;break}return e.a(2);case 1:return e.n=2,a.value.validate(function(){var e=c(i().m((function e(t){var a,o;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!t){e.n=5;break}return e.p=1,l.value=!0,e.n=2,i=n.value.text,c=n.value.topK,r.get("/v1".concat(R,"rest/").concat(P,"/knowledge/retrieve"),{params:{"query-text":i,"top-k":c}});case 2:o=e.v,u.value=(null===(a=o.data)||void 0===a?void 0:a.data)||[],e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,l.value=!1,e.f(4);case 5:return e.a(2)}var i,c}),e,null,[[1,3,4,5]])})));return function(t){return e.apply(this,arguments)}}());case 2:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),k=!0,S=function(e){"Enter"!==e.key||e.shiftKey||(k=!0,e.preventDefault())},T=function(){k=!1},j=function(){k&&(k=!1,p())};return function(e,r){var i=f("loading");return v(),b("div",me,[m("div",he,[m("div",ge,[_((v(),E(x(A),{ref:"tableRef",data:u.value,style:{width:"100%",height:"100%"},border:""},{default:g((function(){return[h(x(W),{label:x(o)("kb.outline"),width:"300"},{default:g((function(e){return[h(x(N),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:g((function(){return[m("div",we,y(e.row.outline),1)]})),default:g((function(){return[m("div",ye,[m("div",xe,y(e.row.outline),1)])]})),_:2},1024)]})),_:1},8,["label"]),h(x(W),{prop:"denseMetricType",label:x(o)("kb.knowledge.hit.test.dense.metric"),width:"170"},null,8,["label"]),h(x(W),{label:x(o)("kb.knowledge.hit.test.dense.score"),width:"170",formatter:function(e){return d(e.denseScore)}},{header:g((function(){return[m("div",ke,[m("span",null,y(x(o)("kb.knowledge.hit.test.dense.score")),1),h(x(F),{effect:"dark",placement:"top","raw-content":!0,content:x(o)("kb.knowledge.hit.test.score.tip")},{default:g((function(){return[h(x(G),{class:"info-icon"},{default:g((function(){return[h(x(Z))]})),_:1})]})),_:1},8,["content"])])]})),_:1},8,["label","formatter"]),h(x(W),{prop:"sparseMetricType",label:x(o)("kb.knowledge.hit.test.sparse.metric"),width:"170"},null,8,["label"]),h(x(W),{label:x(o)("kb.knowledge.hit.test.sparse.score"),width:"170",formatter:function(e){return d(e.sparseScore)}},null,8,["label","formatter"]),h(x(W),{label:x(o)("kb.knowledge.hit.test.hybrid.score"),width:"170",formatter:function(e){var t;return d(null!==(t=e.hybridScore)&&void 0!==t?t:e.score)}},null,8,["label","formatter"]),h(x(W),{label:x(o)("kb.textChunk"),width:"400"},{default:g((function(e){return[h(x(N),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:g((function(){return[m("div",_e,y(e.row.textChunk),1)]})),default:g((function(){return[m("div",Ee,y(e.row.textChunk),1)]})),_:2},1024)]})),_:1},8,["label"]),h(x(W),{prop:"isFiltered",label:x(o)("kb.knowledge.hit.test.is.hit"),width:"150",formatter:function(e){return e.isFiltered?x(o)("common.no"):x(o)("common.yes")}},null,8,["label","formatter"]),h(x(W),{prop:"dimension",label:x(o)("kb.dimension"),width:"130"},null,8,["label"]),h(x(W),{prop:"embeddingModel",label:x(o)("kb.embeddingModel"),width:"150"},null,8,["label"]),h(x(W),{prop:"embeddingProvider",label:x(o)("kb.embeddingProvider"),width:"150"},null,8,["label"])]})),_:1},8,["data"])),[[i,l.value]])])]),m("div",Se,[h(x(q),{ref_key:"formRef",ref:a,model:n.value,"label-width":"120px"},{default:g((function(){return[h(x(B),{label:"TOP-K",prop:"topK",rules:[{required:!0,message:x(o)("common.input.required")}]},{default:g((function(){return[h(x(H),{class:"top-k-input",modelValue:n.value.topK,"onUpdate:modelValue":r[0]||(r[0]=function(e){return n.value.topK=e}),min:1,max:15,"controls-position":"right"},null,8,["modelValue"])]})),_:1},8,["rules"]),h(x(B),{label:x(o)("kb.knowledge.hit.test.text"),prop:"text",class:"input-area",rules:[{required:!0,message:x(o)("common.input.required")}]},{default:g((function(){return[h(x(K),{modelValue:n.value.text,"onUpdate:modelValue":r[1]||(r[1]=function(e){return n.value.text=e}),class:"text-input",placeholder:x(o)("kb.knowledge.hit.test.text.placeholder"),type:"textarea",autosize:{minRows:5,maxRows:10},maxlength:4e3,"show-word-limit":"",onKeydown:S,onInput:T,onKeyup:j},null,8,["modelValue","placeholder"]),h(x(M),{type:"primary",onClick:p},{default:g((function(){return t(r[2]||(r[2]=[w("æäº¤",-1)]))})),_:1})]})),_:1},8,["label","rules"])]})),_:1},8,["model"])])])}}}),je=I(Te,[["__scopeId","data-v-dceb1c4e"]]),Oe={class:"rag-settings-page"},Ve={class:"section-title"},Ce={class:"rag-weight-slider"},Re={class:"rag-weight-values"},Pe={class:"settings-actions"},Ie="RETRIEVE_TOP_K",Me="RETRIEVE_METRIC_TYPE",Ke="RETRIEVE_METRIC_SCORE_COMPARE_EXPR",We="RETRIEVE_DENSE_WEIGHT",Ne="RETRIEVE_SPARSE_WEIGHT",Ae=u({__name:"RagSettings",setup:function(e){var t=s(!1),n=s(!1),r=s({topK:5,metricType:"COSINE",metricScoreExpr:"> 0.7",denseWeight:.5,sparseWeight:.5}),a=function(){var e=r.value.denseWeight,t=r.value.sparseWeight,n=e+t;if(!Number.isFinite(n)||n<=0)return r.value.denseWeight=.5,void(r.value.sparseWeight=.5);r.value.denseWeight=e/n,r.value.sparseWeight=t/n},l=O({get:function(){return Math.round(100*r.value.denseWeight)},set:function(e){var t=Math.min(100,Math.max(0,e));r.value.denseWeight=t/100,r.value.sparseWeight=(100-t)/100}}),u=function(e){var t=Math.min(100,Math.max(0,Math.round(e))),n=100-t;return"".concat(o("settings.rag.weight.dense"),": ").concat(t,"% / ").concat(o("settings.rag.weight.sparse"),": ").concat(n,"%")},d=function(e,t){if(null==e)return t;var n=Number(e);return Number.isFinite(n)?n:t},k=function(e){var t,n;return null!=e&&null!==(t=e.data)&&void 0!==t&&t.data?e.data.data:null!==(n=null==e?void 0:e.data)&&void 0!==n?n:{}},E=function(){var e=c(i().m((function e(){var n,l;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return t.value=!0,e.p=1,e.n=2,ee([Ie,Me,Ke,We,Ne]);case 2:n=e.v,l=k(n),r.value.topK=d(Ie in l?l.RETRIEVE_TOP_K:void 0,r.value.topK),r.value.metricType=l.RETRIEVE_METRIC_TYPE||r.value.metricType,r.value.metricScoreExpr=l.RETRIEVE_METRIC_SCORE_COMPARE_EXPR||r.value.metricScoreExpr,r.value.denseWeight=d(We in l?l.RETRIEVE_DENSE_WEIGHT:void 0,r.value.denseWeight),r.value.sparseWeight=d(Ne in l?l.RETRIEVE_SPARSE_WEIGHT:void 0,r.value.sparseWeight),a(),e.n=4;break;case 3:e.p=3,e.v,D.error(o("settings.load.failed"));case 4:return e.p=4,t.value=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return n.value=!0,e.p=1,a(),e.n=2,te([{propertyName:Ie,propertyValue:String(r.value.topK)},{propertyName:Me,propertyValue:r.value.metricType},{propertyName:Ke,propertyValue:r.value.metricScoreExpr},{propertyName:We,propertyValue:String(r.value.denseWeight)},{propertyName:Ne,propertyValue:String(r.value.sparseWeight)}]);case 2:D.success(o("settings.save.success")),e.n=4;break;case 3:e.p=3,e.v,D.error(o("settings.save.failed"));case 4:return e.p=4,n.value=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}();return p((function(){E()})),function(e,a){var i=f("loading");return _((v(),b("div",Oe,[m("div",Ve,y(x(o)("settings.rag.section")),1),h(x(q),{model:r.value,"label-width":"220px"},{default:g((function(){return[h(x(B),{label:x(o)("settings.rag.topk")},{default:g((function(){return[h(x(H),{modelValue:r.value.topK,"onUpdate:modelValue":a[0]||(a[0]=function(e){return r.value.topK=e}),min:1},null,8,["modelValue"])]})),_:1},8,["label"]),h(x(B),{label:x(o)("settings.rag.metric.type.dense")},{default:g((function(){return[h(x(L),{modelValue:r.value.metricType,"onUpdate:modelValue":a[1]||(a[1]=function(e){return r.value.metricType=e}),class:"settings-select"},{default:g((function(){return[h(x(X),{label:"COSINE",value:"COSINE"}),h(x(X),{label:"IP",value:"IP"}),h(x(X),{label:"L2",value:"L2"})]})),_:1},8,["modelValue"])]})),_:1},8,["label"]),h(x(B),{label:x(o)("settings.rag.metric.type.sparse")},{default:g((function(){return[h(x(L),{"model-value":"BM25",class:"settings-select",disabled:""},{default:g((function(){return[h(x(X),{label:"BM25",value:"BM25"})]})),_:1})]})),_:1},8,["label"]),h(x(B),{label:x(o)("settings.rag.weight.label")},{default:g((function(){return[m("div",Ce,[h(x(Y),{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=function(e){return l.value=e}),min:0,max:100,"show-tooltip":!0,"format-tooltip":u},null,8,["modelValue"]),m("div",Re,[m("span",null,y(x(o)("settings.rag.weight.dense"))+": "+y(l.value)+"%",1),m("span",null,y(x(o)("settings.rag.weight.sparse"))+": "+y(100-l.value)+"%",1)])])]})),_:1},8,["label"]),h(x(B),{label:x(o)("settings.rag.metric.score.expr")},{default:g((function(){return[h(x(K),{modelValue:r.value.metricScoreExpr,"onUpdate:modelValue":a[3]||(a[3]=function(e){return r.value.metricScoreExpr=e})},null,8,["modelValue"])]})),_:1},8,["label"])]})),_:1},8,["model"]),m("div",Pe,[h(x(M),{type:"primary",loading:n.value,onClick:S},{default:g((function(){return[w(y(x(o)("settings.save")),1)]})),_:1},8,["loading"])])])),[[i,t.value]])}}}),Ue=I(Ae,[["__scopeId","data-v-26bd28c5"]]),ze={class:"layout-container"},De={class:"content-wrapper"},Fe={class:"main-content"},Ge={class:"content-area"},Be={key:1,class:"placeholder"},He=u({__name:"index",setup:function(e){var n=s(!1),r=s("1"),a=V(be),i=function(e,t){},l=function(e,t){},u=function(e,t){switch(r.value=e,e){default:a.value=be;break;case"2":a.value=je;break;case"3":a.value=Ue}};return function(e,c){return v(),b("div",ze,[h(J),m("div",De,[h(x($),{"default-active":r.value,class:"el-menu-vertical-demo",collapse:n.value,onOpen:i,onClose:l,onSelect:u},{default:g((function(){return[h(x(Q),{index:"1"},{default:g((function(){return[w(y(x(o)("kb.knowledge.list")),1)]})),_:1}),h(x(Q),{index:"2"},{default:g((function(){return[w(y(x(o)("kb.knowledge.hit.test")),1)]})),_:1}),h(x(Q),{index:"3"},{default:g((function(){return[w(y(x(o)("settings.rag.section")),1)]})),_:1})]})),_:1},8,["default-active","collapse"]),m("main",Fe,[m("div",Ge,[a.value?(v(),E(C(a.value),{key:0})):(v(),b("div",Be,t(c[0]||(c[0]=[m("p",null,"è¯·é€‰æ‹©ä¸€ä¸ªèœå•é¡¹",-1)]))))])])])])}}}),qe=I(He,[["__scopeId","data-v-e012f15a"]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"}));e("a",Le)}}}))}();
