!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return l(s,"_invoke",function(n,r,a){var o,i,l,c=0,s=a||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,i=0,l=e,p.n=n,u}};function f(n,r){for(i=n,l=r,t=0;!d&&c&&!a&&t<s.length;t++){var a,o=s[t],f=p.p,v=o[2];n>3?(a=v===r)&&(l=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((a=n<2&&f<o[1])?(i=0,p.v=r,p.n=o[1]):f<v&&(a=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,p.n=v,i=0))}if(a||n>1)return u;throw d=!0,r}return function(a,s,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,v),i=s,l=v;(t=i<2?e:l)||!d;){o||(i?i<3?(i>1&&(p.n=-1),f(i,l)):p.n=l:p.v=l);try{if(c=2,o){if(i||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=o.return)&&t.call(o),i<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=e}else if((t=(d=p.n<0)?l:n.call(r,p))!==u)break}catch(t){o=e,i=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,a,o),!0),s}var u={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),f=d.prototype=c.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=d,l(f,"constructor",d),l(d,"constructor",s),s.displayName="GeneratorFunction",l(d,a,"GeneratorFunction"),l(f),l(f,a,"Generator"),l(f,r,(function(){return this})),l(f,"toString",(function(){return"[object Generator]"})),(i=function(){return{w:o,m:v}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){function o(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},l(e,t,n,r)}function u(e,t,n,r,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){u(o,r,a,i,l,"next",e)}function l(e){u(o,r,a,i,l,"throw",e)}i(void 0)}))}}var s=document.createElement("style");s.innerHTML=".kb-table-container[data-v-6e5e5748]{font-family:Arial,sans-serif;padding:20px;height:100%;min-width:800px;display:flex;flex-direction:column;box-sizing:border-box;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.kb-table-container .header-actions[data-v-6e5e5748]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-shrink:0}.kb-table-container .header-actions .search-area[data-v-6e5e5748],.kb-table-container .header-actions .btn-area[data-v-6e5e5748]{display:flex;gap:10px}.kb-table-container .table-wrapper[data-v-6e5e5748]{border-radius:var(--n-radius-triple);flex:1;overflow:hidden}.kb-table-container .table-wrapper[data-v-6e5e5748] .el-table{height:100%!important}.kb-table-container .pagination-wrapper[data-v-6e5e5748]{margin-top:16px;display:flex;justify-content:flex-end;flex-shrink:0}.kb-table-container .text-chunk-preview[data-v-6e5e5748],.kb-table-container .outline-preview[data-v-6e5e5748]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;color:var(--el-color-primary)}.kb-table-container .text-chunk-full[data-v-6e5e5748],.kb-table-container .outline-full[data-v-6e5e5748]{max-height:300px;overflow-y:auto}.hit-test-container[data-v-5e691982]{font-family:Arial,sans-serif;height:100%}.hit-test-container .header-with-tooltip[data-v-5e691982]{display:flex;align-items:center;gap:4px}.hit-test-container .hit-test-result[data-v-5e691982]{padding:20px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple);min-height:300px;height:calc(100% - 255px)}.hit-test-container .hit-test-result .table-wrapper[data-v-5e691982]{height:100%;border-radius:var(--n-radius-triple);flex:1;overflow:hidden;display:flex;flex-direction:column}.hit-test-container .hit-test-result .table-wrapper .table-header[data-v-5e691982]{display:flex;align-items:center;justify-content:flex-start;gap:12px;padding:8px 12px;border-bottom:1px solid var(--el-border-color-lighter);background-color:var(--el-fill-color-lighter)}.hit-test-container .hit-test-result .table-wrapper .table-header .table-header-title[data-v-5e691982]{font-weight:600;color:var(--n-color-font-dark);white-space:nowrap}.hit-test-container .hit-test-result .table-wrapper .table-header .rag-weight-slider[data-v-5e691982]{flex:0 0 auto}.hit-test-container .hit-test-result .table-wrapper .rag-weight-slider[data-v-5e691982]{width:280px}.hit-test-container .hit-test-result .table-wrapper .rag-weight-slider[data-v-5e691982] .el-slider__runway{background-color:#f4a340}.hit-test-container .hit-test-result .table-wrapper .rag-weight-slider[data-v-5e691982] .el-slider__bar{background-color:var(--el-slider-main-bg-color)}.hit-test-container .hit-test-result .table-wrapper .rag-weight-slider .rag-weight-values[data-v-5e691982]{display:flex;justify-content:space-between;margin-top:4px;color:var(--n-color-neutral-6);font-size:12px}.hit-test-container .hit-test-result .table-wrapper .rag-weight-slider.compact .rag-weight-values[data-v-5e691982]{margin-top:2px}.hit-test-container .hit-test-result .table-wrapper[data-v-5e691982] .el-table{height:100%!important}.hit-test-container .hit-test-result .text-chunk-preview[data-v-5e691982],.hit-test-container .hit-test-result .outline-preview[data-v-5e691982]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;color:var(--el-color-primary)}.hit-test-container .hit-test-form[data-v-5e691982]{height:235px;margin-top:20px;padding:20px;display:flex;flex-direction:column;box-sizing:border-box;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.hit-test-container .hit-test-form .rag-weight-summary[data-v-5e691982]{display:flex;align-items:center;gap:12px;margin-bottom:12px;font-size:14px;color:var(--n-color-font-dark)}.hit-test-container .hit-test-form .rag-weight-summary .label[data-v-5e691982]{font-weight:600}.hit-test-container .hit-test-form[data-v-5e691982] .el-form-item__label{color:var(--n-color-font-dark);justify-content:flex-start}.hit-test-container .hit-test-form .top-k-input[data-v-5e691982]{width:100px;margin-right:10px}.hit-test-container .hit-test-form .top-k-input[data-v-5e691982] .el-form-item{margin-bottom:20px}.hit-test-container .hit-test-form .top-k-input[data-v-5e691982] .el-input__wrapper{height:40px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%)}.hit-test-container .hit-test-form .top-k-input[data-v-5e691982] .el-input-number{width:100%}.hit-test-container .hit-test-form .top-k-input[data-v-5e691982] .el-input-number .el-input__inner{text-align:left}.hit-test-container .hit-test-form .input-area .el-textarea[data-v-5e691982]{margin-bottom:5px}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-5e691982] .el-input__count{right:80px;bottom:15px;background:rgba(255,255,255,0)}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-5e691982] .el-textarea__inner{background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);padding:15px 20px;border-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);word-wrap:break-word;word-break:break-all;box-shadow:none}.hit-test-container .hit-test-form .input-area .el-textarea.text-input[data-v-5e691982] :hover{box-shadow:0 0 12px color-mix(in srgb,var(--el-color-primary-light-3),transparent 10%)}.hit-test-container .hit-test-form .input-area .el-button[data-v-5e691982]{position:absolute;right:10px;bottom:30px}.rag-settings-page[data-v-6d255d32]{padding:20px;background-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 30%);backdrop-filter:blur(10px);border-radius:var(--n-radius-triple)}.layout-container[data-v-e012f15a]{display:flex;flex-direction:column;height:100vh;overflow:hidden}.layout-container .content-wrapper[data-v-e012f15a]{display:flex;flex:1;overflow:hidden}.layout-container .content-wrapper[data-v-e012f15a] .el-menu{padding-top:60px;border-right:none;height:100%;background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);border-right:1px solid rgba(255,255,255,.18);box-shadow:0 8px 32px rgba(31,38,135,.1)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item{border-radius:8px;margin:5px 10px;transition:all .3s;color:var(--n-color-font-dark)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item.is-active,.layout-container .content-wrapper[data-v-e012f15a] .el-menu-item:hover{background-color:var(--el-color-primary);color:var(--n-color-neutral-w)}.layout-container .content-wrapper[data-v-e012f15a] .el-menu--collapse .el-menu-item{margin:5px}.layout-container .content-wrapper .main-content[data-v-e012f15a]{padding-top:50px;flex:1;display:flex;flex-direction:column;overflow:hidden}.layout-container .content-wrapper .main-content .content-area[data-v-e012f15a]{flex:1;overflow:auto;padding:20px}.layout-container .content-wrapper .main-content .content-area .placeholder[data-v-e012f15a]{display:flex;justify-content:center;align-items:center;height:100%;font-size:18px;color:#999}\n",document.head.appendChild(s),System.register(["../index-legacy-b49d3d89.js","./@vue-legacy-799a045e.js","./plugin-vue_export-helper-legacy-1285489a.js","./element-plus-legacy-92646882.js","./topoBar-legacy-57215da9.js","./RagSettingsPanel-legacy-dbf3e6fa.js","./@element-plus-legacy-931e6d36.js"],(function(e,n){"use strict";var r,o,l,u,s,d,p,f,v,h,b,m,g,w,y,x,k,_,E,T,S,R,j,O,I,P,C,W,V,M,N,K,A,D,G,z,F,H,U,B,q,X,Y,L,Q,$,J,Z,ee;return{setters:[function(e){r=e.e,o=e.g,l=e.p,u=e.t,s=e._},function(e){d=e.d,p=e.r,f=e.at,v=e.f,h=e.aa,b=e.o,m=e.c,g=e.a,w=e.X,y=e.M,x=e.a4,k=e.Q,_=e.u,E=e.al,T=e.U,S=e.A,R=e.K,j=e.ab,O=e.n,I=e.j,P=e.s,C=e.O},function(e){W=e._},function(e){V=e.f,M=e.d,N=e.p,K=e.q,A=e.r,D=e.s,G=e.i,z=e.a,F=e.t,H=e.u,U=e.m,B=e.c,q=e.v,X=e.g,Y=e.w,L=e.x},function(e){Q=e.T},function(e){$=e.g,J=e.R,Z=e.p},function(e){ee=e.C}],execute:function(){function te(e){if(!e||isNaN(e))return"";var t=new Date(e),n=t.getMonth()+1;n<10&&(n="0"+n);var r=t.getDate();r<10&&(r="0"+r);var a=t.getHours();a<10&&(a="0"+a);var o=t.getMinutes();o<10&&(o="0"+o);var i=t.getSeconds();return i<10&&(i="0"+i),t.getFullYear()+"-"+n+"-"+r+" "+a+":"+o+":"+i}var ne=function(e){return r.post("/v1".concat(o,"rest/").concat(l,"/knowledge/delete"),e)},re=(e("p",(function(e){return r.put("/v1".concat(o,"rest/").concat(l,"/knowledge"),e)})),e("d",(function(){window.open("/v1".concat(o,"rest/").concat(l,"/knowledge/json-template"))})),e("i",(function(e){var t=new FormData;return t.append("jsonTemplate",e),r.post("/v1".concat(o,"rest/").concat(l,"/knowledge/json-template"),t)})),{class:"kb-table-container"}),ae={class:"header-actions"},oe={class:"btn-area"},ie={class:"search-area"},le={class:"table-wrapper"},ue={class:"outline-preview"},ce={class:"outline-full"},se={class:"text-chunk-preview"},de={class:"text-chunk-full"},pe={class:"pagination-wrapper"},fe=d({__name:"KnowledgeBaseList",setup:function(e){var d=p([]),I=p(!1),P=p(1),C=p(10),W=p(0),F=p(""),H=p([]),U=f((function(){return s((function(){return n.import("./KbAddDialog-legacy-febcf1c9.js")}),void 0)})),B=f((function(){return s((function(){return n.import("./KbEditDialog-legacy-c1b8b4df.js")}),void 0)})),q=p(!1),X=p(!1),Y=p(null),L=function(){var e=c(i().m((function e(){var t,n,a;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return I.value=!0,e.p=1,e.n=2,i=(P.value-1)*C.value,u=C.value+1,c=F.value,r.get("/v1".concat(o,"rest/").concat(l,"/knowledge"),{params:{offset:i,limit:u,search:c}});case 2:n=e.v,(a=(null===(t=n.data)||void 0===t?void 0:t.data)||[]).length>C.value?(d.value=a.slice(0,C.value),W.value=(P.value+1)*C.value):(d.value=a,W.value=(P.value-1)*C.value+a.length),e.n=4;break;case 3:e.p=3,e.v,d.value=[],W.value=0;case 4:return e.p=4,I.value=!1,e.f(4);case 5:return e.a(2)}var i,u,c}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),Q=function(e){C.value=e,L()},$=function(e){P.value=e,L()},J=function(){P.value=1,L()},Z=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,O();case 1:q.value=!0,e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){q.value=!1,L()},fe=function(){X.value=!1,L()},ve=function(e){H.value=e},he=function(){0!==H.value.length&&G.confirm("ç¡®è®¤åˆ é™¤é€‰ä¸­çš„ ".concat(H.value.length," é¡¹æ•°æ®å—ï¼Ÿ"),"è­¦å‘Š",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(c(i().m((function e(){var t;return i().w((function(e){for(;;)switch(e.n){case 0:return t=H.value.map((function(e){return e.textChunkId})),e.n=1,ne(t);case 1:z.success("åˆ é™¤æˆåŠŸ"),L();case 2:return e.a(2)}}),e)})))).catch((function(){}))};return v((function(){L()})),function(e,n){var r=h("loading");return b(),m("div",re,[g("div",ae,[g("div",oe,[w(_(V),{type:"primary",onClick:L},{default:y((function(){return[x(k("ğŸ”„ "+_(u)("common.refresh")),1)]})),_:1}),w(_(V),{type:"primary",onClick:Z},{default:y((function(){return[x(k("â• "+_(u)("common.add")),1)]})),_:1}),w(_(V),{type:"danger",disabled:0===H.value.length,onClick:he},{default:y((function(){return[x(k("ğŸ—‘ï¸ "+_(u)("common.delete")),1)]})),_:1},8,["disabled"])]),g("div",ie,[w(_(M),{modelValue:F.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return F.value=e}),placeholder:_(u)("common.search.placeholder.keyword"),clearable:"",style:{width:"240px"},onKeyup:E(J,["enter"]),onClear:J},null,8,["modelValue","placeholder"]),w(_(V),{type:"primary",onClick:J},{default:y((function(){return[x(k("ğŸ”ï¸ "+_(u)("common.search")),1)]})),_:1})])]),g("div",le,[T((b(),S(_(A),{ref:"tableRef",data:d.value,style:{width:"100%",height:"100%"},border:"",onSelectionChange:ve},{default:y((function(){return[w(_(N),{type:"selection",width:"55",align:"center"}),w(_(N),{label:_(u)("kb.outline"),width:"300"},{default:y((function(e){return[w(_(K),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:y((function(){return[g("div",ue,k((t=e.row.outline,t&&0!==t.length?t.length<=3?t.join(" | "):"".concat(t.slice(0,3).join(", "),"... (+").concat(t.length-3,"é¡¹)"):"-")),1)];var t})),default:y((function(){return[g("div",ce,[(b(!0),m(R,null,j(e.row.outline,(function(e,t){return b(),m("div",{key:t},k(t+1)+". "+k(e),1)})),128))])]})),_:2},1024)]})),_:1},8,["label"]),w(_(N),{label:_(u)("kb.textChunk"),width:"300"},{default:y((function(e){return[w(_(K),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:y((function(){return[g("div",se,k(e.row.textChunk),1)]})),default:y((function(){return[g("div",de,k(e.row.textChunk),1)]})),_:2},1024)]})),_:1},8,["label"]),w(_(N),{prop:"description",label:_(u)("kb.description"),"min-width":"150","show-overflow-tooltip":""},null,8,["label"]),w(_(N),{prop:"dimension",label:_(u)("kb.dimension"),width:"130"},null,8,["label"]),w(_(N),{prop:"embeddingModel",label:_(u)("kb.embeddingModel"),width:"150"},null,8,["label"]),w(_(N),{prop:"embeddingProvider",label:_(u)("kb.embeddingProvider"),width:"150"},null,8,["label"]),w(_(N),{prop:"createTime",label:_(u)("common.create.time"),width:"180"},{default:y((function(e){return[x(k(_(te)(e.row.createTime)),1)]})),_:1},8,["label"]),w(_(N),{prop:"updateTime",label:_(u)("common.update.time"),width:"180"},{default:y((function(e){return[x(k(_(te)(e.row.updateTime)),1)]})),_:1},8,["label"]),w(_(N),{prop:"createUsername",label:_(u)("kb.create.username"),width:"150"},null,8,["label"]),w(_(N),{label:_(u)("common.action"),width:"120",align:"center",fixed:"right"},{default:y((function(e){return[w(_(V),{type:"primary",link:"",onClick:function(n){return r=e.row,Y.value=a(a({},r),{},{outline:r.outline?t(r.outline):[]}),void(X.value=!0);var r}},{default:y((function(){return[x(k(_(u)("common.edit")),1)]})),_:1},8,["onClick"]),w(_(V),{type:"danger",link:"",onClick:function(t){var n;null!=(n=e.row)&&n.textChunkId&&G.confirm("ç¡®è®¤åˆ é™¤è¯¥æ¡æ•°æ®å—ï¼Ÿ","è­¦å‘Š",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(c(i().m((function e(){return i().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,ne([n.textChunkId]);case 1:z.success("åˆ é™¤æˆåŠŸ"),L();case 2:return e.a(2)}}),e)})))).catch((function(){}))}},{default:y((function(){return[x(k(_(u)("common.delete")),1)]})),_:1},8,["onClick"])]})),_:1},8,["label"])]})),_:1},8,["data"])),[[r,I.value]])]),g("div",pe,[w(_(D),{"current-page":P.value,"onUpdate:currentPage":n[1]||(n[1]=function(e){return P.value=e}),"page-size":C.value,"onUpdate:pageSize":n[2]||(n[2]=function(e){return C.value=e}),"page-sizes":[10,20,50,100],total:W.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Q,onCurrentChange:$},null,8,["current-page","page-size","total"])]),w(_(U),{modelValue:q.value,"onUpdate:modelValue":n[3]||(n[3]=function(e){return q.value=e}),onAddSuccess:ee},null,8,["modelValue"]),w(_(B),{modelValue:X.value,"onUpdate:modelValue":n[4]||(n[4]=function(e){return X.value=e}),knowledge:Y.value,onEditSuccess:fe},null,8,["modelValue","knowledge"])])}}}),ve=W(fe,[["__scopeId","data-v-6e5e5748"]]),he={class:"hit-test-container"},be={class:"hit-test-result"},me={class:"table-wrapper"},ge={class:"table-header"},we={class:"table-header-title"},ye={class:"rag-weight-slider compact"},xe={class:"rag-weight-values"},ke={class:"outline-preview"},_e={class:"outline-full"},Ee={class:"text-chunk-full"},Te={class:"header-with-tooltip"},Se={class:"header-with-tooltip"},Re={class:"text-chunk-preview"},je={class:"text-chunk-full"},Oe={class:"hit-test-form"},Ie="RETRIEVE_DENSE_WEIGHT",Pe="RETRIEVE_SPARSE_WEIGHT",Ce=d({__name:"HitTest",setup:function(e){var n=p({text:"",topK:5}),a=p(),s=p(!1),d=p([]),f=p({denseWeight:.5,sparseWeight:.5}),E=function(){var e=f.value.denseWeight,t=f.value.sparseWeight,n=e+t;if(!Number.isFinite(n)||n<=0)return f.value.denseWeight=.5,void(f.value.sparseWeight=.5);f.value.denseWeight=e/n,f.value.sparseWeight=t/n},R=function(e,t){if(null==e)return t;var n=Number(e);return Number.isFinite(n)?n:t},j=function(e){var t,n;return null!=e&&null!==(t=e.data)&&void 0!==t&&t.data?e.data.data:null!==(n=null==e?void 0:e.data)&&void 0!==n?n:{}},O=I((function(){return Math.round(100*f.value.denseWeight)})),P=I((function(){return 100-O.value})),C=function(e){var t=Math.min(100,Math.max(0,Math.round(e))),n=100-t;return"".concat(u("settings.rag.weight.dense"),": ").concat(t,"% / ").concat(u("settings.rag.weight.sparse"),": ").concat(n,"%")},W=function(e){return Number.isFinite(e)?e.toFixed(4):"-"},D=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.n){case 0:if(a.value){e.n=1;break}return e.a(2);case 1:return e.n=2,a.value.validate(function(){var e=c(i().m((function e(t){var a,u;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!t){e.n=5;break}return e.p=1,s.value=!0,e.n=2,i=n.value.text,c=n.value.topK,r.get("/v1".concat(o,"rest/").concat(l,"/knowledge/retrieve"),{params:{"query-text":i,"top-k":c}});case 2:u=e.v,d.value=(null===(a=u.data)||void 0===a?void 0:a.data)||[],e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,s.value=!1,e.f(4);case 5:return e.a(2)}var i,c}),e,null,[[1,3,4,5]])})));return function(t){return e.apply(this,arguments)}}());case 2:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),G=!0,z=function(e){"Enter"!==e.key||e.shiftKey||(G=!0,e.preventDefault())},Y=function(){G=!1},L=function(){G&&(G=!1,D())},Q=function(){var e=c(i().m((function e(){var t,n;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,$([Ie,Pe]);case 1:t=e.v,n=j(t),f.value.denseWeight=R(Ie in n?n.RETRIEVE_DENSE_WEIGHT:void 0,f.value.denseWeight),f.value.sparseWeight=R(Pe in n?n.RETRIEVE_SPARSE_WEIGHT:void 0,f.value.sparseWeight),E(),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}();return v((function(){Q()})),function(e,r){var o=h("loading");return b(),m("div",he,[g("div",be,[g("div",me,[g("div",ge,[g("span",we,k(_(u)("settings.rag.weight.label")),1),g("div",ye,[w(_(F),{"model-value":O.value,min:0,max:100,"show-tooltip":!0,"format-tooltip":C,disabled:""},null,8,["model-value"]),g("div",xe,[g("span",null,k(_(u)("settings.rag.weight.dense"))+": "+k(O.value)+"%",1),g("span",null,k(_(u)("settings.rag.weight.sparse"))+": "+k(P.value)+"%",1)])])]),T((b(),S(_(A),{ref:"tableRef",data:d.value,style:{width:"100%",height:"100%"},border:""},{default:y((function(){return[w(_(N),{label:_(u)("kb.outline"),width:"300"},{default:y((function(e){return[w(_(K),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:y((function(){return[g("div",ke,k(e.row.outline),1)]})),default:y((function(){return[g("div",_e,[g("div",Ee,k(e.row.outline),1)])]})),_:2},1024)]})),_:1},8,["label"]),w(_(N),{prop:"denseMetricType",label:_(u)("kb.knowledge.hit.test.dense.metric"),width:"170"},null,8,["label"]),w(_(N),{label:_(u)("kb.knowledge.hit.test.dense.score"),width:"170",formatter:function(e){return W(e.denseScore)}},{header:y((function(){return[g("div",Te,[g("span",null,k(_(u)("kb.knowledge.hit.test.dense.score")),1),w(_(H),{effect:"dark",placement:"top","raw-content":!0,content:_(u)("kb.knowledge.hit.test.dense.score.tip")},{default:y((function(){return[w(_(U),{class:"info-icon"},{default:y((function(){return[w(_(ee))]})),_:1})]})),_:1},8,["content"])])]})),_:1},8,["label","formatter"]),w(_(N),{prop:"sparseMetricType",label:_(u)("kb.knowledge.hit.test.sparse.metric"),width:"170"},null,8,["label"]),w(_(N),{label:_(u)("kb.knowledge.hit.test.sparse.score"),width:"170",formatter:function(e){return W(e.sparseScore)}},{header:y((function(){return[g("div",Se,[g("span",null,k(_(u)("kb.knowledge.hit.test.sparse.score")),1),w(_(H),{effect:"dark",placement:"top","raw-content":!0,content:_(u)("kb.knowledge.hit.test.sparse.score.tip")},{default:y((function(){return[w(_(U),{class:"info-icon"},{default:y((function(){return[w(_(ee))]})),_:1})]})),_:1},8,["content"])])]})),_:1},8,["label","formatter"]),w(_(N),{label:_(u)("kb.knowledge.hit.test.hybrid.score"),width:"170",formatter:function(e){var t;return W(null!==(t=e.hybridScore)&&void 0!==t?t:e.score)}},null,8,["label","formatter"]),w(_(N),{prop:"isFiltered",label:_(u)("kb.knowledge.hit.test.is.hit"),width:"150",formatter:function(e){return e.isFiltered?_(u)("common.no"):_(u)("common.yes")}},null,8,["label","formatter"]),w(_(N),{label:_(u)("kb.textChunk"),width:"400"},{default:y((function(e){return[w(_(K),{effect:"dark",trigger:"hover",placement:"top",width:"400"},{reference:y((function(){return[g("div",Re,k(e.row.textChunk),1)]})),default:y((function(){return[g("div",je,k(e.row.textChunk),1)]})),_:2},1024)]})),_:1},8,["label"]),w(_(N),{prop:"dimension",label:_(u)("kb.dimension"),width:"130"},null,8,["label"]),w(_(N),{prop:"embeddingModel",label:_(u)("kb.embeddingModel"),width:"150"},null,8,["label"]),w(_(N),{prop:"embeddingProvider",label:_(u)("kb.embeddingProvider"),width:"150"},null,8,["label"])]})),_:1},8,["data"])),[[o,s.value]])])]),g("div",Oe,[w(_(X),{ref_key:"formRef",ref:a,model:n.value,"label-width":"120px"},{default:y((function(){return[w(_(B),{label:"TOP-K",prop:"topK",rules:[{required:!0,message:_(u)("common.input.required")}]},{default:y((function(){return[w(_(q),{class:"top-k-input",modelValue:n.value.topK,"onUpdate:modelValue":r[0]||(r[0]=function(e){return n.value.topK=e}),min:1,max:15,"controls-position":"right"},null,8,["modelValue"])]})),_:1},8,["rules"]),w(_(B),{label:_(u)("kb.knowledge.hit.test.text"),prop:"text",class:"input-area",rules:[{required:!0,message:_(u)("common.input.required")}]},{default:y((function(){return[w(_(M),{modelValue:n.value.text,"onUpdate:modelValue":r[1]||(r[1]=function(e){return n.value.text=e}),class:"text-input",placeholder:_(u)("kb.knowledge.hit.test.text.placeholder"),type:"textarea",autosize:{minRows:5,maxRows:10},maxlength:4e3,"show-word-limit":"",onKeydown:z,onInput:Y,onKeyup:L},null,8,["modelValue","placeholder"]),w(_(V),{type:"primary",onClick:D},{default:y((function(){return t(r[2]||(r[2]=[x("æäº¤",-1)]))})),_:1})]})),_:1},8,["label","rules"])]})),_:1},8,["model"])])])}}}),We=W(Ce,[["__scopeId","data-v-5e691982"]]),Ve={class:"rag-settings-page"},Me="RETRIEVE_TOP_K",Ne="RETRIEVE_METRIC_TYPE",Ke="RETRIEVE_METRIC_SCORE_COMPARE_EXPR",Ae="RETRIEVE_DENSE_WEIGHT",De="RETRIEVE_SPARSE_WEIGHT",Ge=d({__name:"RagSettings",setup:function(e){var t=p(!1),n=p(!1),r=p({topK:5,metricType:"COSINE",metricScoreExpr:"> 0.7",denseWeight:.5,sparseWeight:.5}),a=p(r.value.metricType),o=function(){var e=r.value.denseWeight,t=r.value.sparseWeight,n=e+t;if(!Number.isFinite(n)||n<=0)return r.value.denseWeight=.5,void(r.value.sparseWeight=.5);r.value.denseWeight=e/n,r.value.sparseWeight=t/n},l=function(e,t){if(null==e)return t;var n=Number(e);return Number.isFinite(n)?n:t},s=function(e){var t,n;return null!=e&&null!==(t=e.data)&&void 0!==t&&t.data?e.data.data:null!==(n=null==e?void 0:e.data)&&void 0!==n?n:{}},d=function(){var e=c(i().m((function e(){var n,c;return i().w((function(e){for(;;)switch(e.p=e.n){case 0:return t.value=!0,e.p=1,e.n=2,$([Me,Ne,Ke,Ae,De]);case 2:n=e.v,c=s(n),r.value.topK=l(Me in c?c.RETRIEVE_TOP_K:void 0,r.value.topK),r.value.metricType=c.RETRIEVE_METRIC_TYPE||r.value.metricType,r.value.metricScoreExpr=c.RETRIEVE_METRIC_SCORE_COMPARE_EXPR||r.value.metricScoreExpr,r.value.denseWeight=l(Ae in c?c.RETRIEVE_DENSE_WEIGHT:void 0,r.value.denseWeight),r.value.sparseWeight=l(De in c?c.RETRIEVE_SPARSE_WEIGHT:void 0,r.value.sparseWeight),o(),a.value=r.value.metricType,e.n=4;break;case 3:e.p=3,e.v,z.error(u("settings.load.failed"));case 4:return e.p=4,t.value=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,G.confirm(u("settings.embedding.rebuild.confirm"),u("settings.embedding.rebuild.title"),{confirmButtonText:u("settings.embedding.rebuild.confirm.ok"),cancelButtonText:u("settings.embedding.rebuild.confirm.cancel"),type:"warning"});case 1:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=c(i().m((function e(){return i().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n.value=!0,e.p=1,a.value===r.value.metricType){e.n=2;break}return e.n=2,f();case 2:return o(),e.n=3,Z([{propertyName:Me,propertyValue:String(r.value.topK)},{propertyName:Ne,propertyValue:r.value.metricType},{propertyName:Ke,propertyValue:r.value.metricScoreExpr},{propertyName:Ae,propertyValue:String(r.value.denseWeight)},{propertyName:De,propertyValue:String(r.value.sparseWeight)}]);case 3:a.value=r.value.metricType,z.success(u("settings.save.success")),e.n=5;break;case 4:e.p=4,"cancel"!==e.v&&z.error(u("settings.save.failed"));case 5:return e.p=5,n.value=!1,e.f(5);case 6:return e.a(2)}}),e,null,[[1,4,5,6]])})));return function(){return e.apply(this,arguments)}}();return v((function(){d()})),function(e,a){var o=h("loading");return T((b(),m("div",Ve,[w(J,{form:r.value,saving:n.value,"show-title":"",onSave:g},null,8,["form","saving"])])),[[o,t.value]])}}}),ze=W(Ge,[["__scopeId","data-v-6d255d32"]]),Fe={class:"layout-container"},He={class:"content-wrapper"},Ue={class:"main-content"},Be={class:"content-area"},qe={key:1,class:"placeholder"},Xe=d({__name:"index",setup:function(e){var n=p(!1),r=p("1"),a=P(ve),o=function(e,t){},i=function(e,t){},l=function(e,t){switch(r.value=e,e){default:a.value=ve;break;case"2":a.value=We;break;case"3":a.value=ze}};return function(e,c){return b(),m("div",Fe,[w(Q),g("div",He,[w(_(L),{"default-active":r.value,class:"el-menu-vertical-demo",collapse:n.value,onOpen:o,onClose:i,onSelect:l},{default:y((function(){return[w(_(Y),{index:"1"},{default:y((function(){return[x(k(_(u)("kb.knowledge.list")),1)]})),_:1}),w(_(Y),{index:"2"},{default:y((function(){return[x(k(_(u)("kb.knowledge.hit.test")),1)]})),_:1}),w(_(Y),{index:"3"},{default:y((function(){return[x(k(_(u)("settings.rag.section")),1)]})),_:1})]})),_:1},8,["default-active","collapse"]),g("main",Ue,[g("div",Be,[a.value?(b(),S(C(a.value),{key:0})):(b(),m("div",qe,t(c[0]||(c[0]=[g("p",null,"è¯·é€‰æ‹©ä¸€ä¸ªèœå•é¡¹",-1)]))))])])])])}}}),Ye=W(Xe,[["__scopeId","data-v-e012f15a"]]),Le=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));e("a",Le)}}}))}();
