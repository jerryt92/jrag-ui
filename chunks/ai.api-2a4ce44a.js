import{S as t}from"./sse.js-610fcddf.js";import{h as e,l as a}from"../index-20a17aa4.js";const o=t=>{if("public"===a){const e={historyContextItem:{contextId:t.contextId,title:"",lastUpdateTime:Date.now()},chatContextDto:t};for(let r=0;r<t.messages.length;r++){const a=t.messages[r];if("user"===a.role){e.historyContextItem.title=a.content.length>64?a.content.substring(0,64):a.content;break}}let a=localStorage.getItem("chatContext");const o=a?JSON.parse(a):{};o[t.contextId]=e,localStorage.setItem("chatContext",JSON.stringify(o))}return Promise.resolve()},r=e=>new t("/v1/rest/jrag/chat",{headers:{"Content-Type":"application/json"},method:"POST",payload:JSON.stringify(e)}),s=()=>e.get("/v1/rest/jrag/api/check"),n=()=>e.get("/v1/rest/jrag/context/id"),c=(t,o)=>{if("public"===a){let t=localStorage.getItem("chatContext");const e=t?JSON.parse(t):{},a={data:Object.values(e).map((t=>t.historyContextItem))};return Promise.resolve({data:a})}return e.get("/v1/rest/jrag/context/list",{params:{offset:t,limit:o}})},i=t=>{if("public"===a){let e=localStorage.getItem("chatContext");const a=e?JSON.parse(e):{};return Promise.resolve({data:a[t]?.chatContextDto})}return e.get("/v1/rest/jrag/context",{params:{"context-id":t}})},l=t=>"user"===a?e.post("/v1/rest/jrag/context/message/feedback",t):Promise.resolve(),g=t=>{if("public"===a){let e=localStorage.getItem("chatContext");const a=e?JSON.parse(e):{};return Array.isArray(t)?t.forEach((t=>{delete a[t]})):delete a[t],localStorage.setItem("chatContext",JSON.stringify(a)),Promise.resolve()}return e.delete("/v1/rest/jrag/context",{params:{"context-id":Array.isArray(t)?t.join(","):t}})},m=t=>new WebSocket(window.location.origin.replace("http","ws")+"/ws/jrag/chat/alive?context-id="+t);export{r as a,n as b,s as c,g as d,i as e,l as f,c as g,m as o,o as s};
