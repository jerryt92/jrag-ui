import{t as e}from"../index-ed01918a.js";import{p as a}from"./index-3866cdcc.js";import{_ as l}from"./plugin-vue_export-helper-3b0dab4c.js";import{c as s,d as o,f as t,g as n,a as u}from"./element-plus-d2b1cdd3.js";import{d as i,r,aa as d,o as c,c as m,U as p,A as v,M as f,X as b,u as h,a as q,K as g,ab as _,a4 as w,Q as k}from"./@vue-bb747027.js";const x={class:"qa-form-container"},y={class:"question-list"},V={class:"submit-btn-container"};var C=l(i({__name:"QAForm",emits:["add-success","loading-change"],setup(l,{expose:i,emit:C}){const j=r(),U=r(!1);i({clearForm:function(){Q.value.id="",Q.value.questions=[""],Q.value.answer="",Q.value.description="",Q.value.tags=[],j.value&&j.value.clearValidate()},setFormData:function(e){Q.value.id=e.id||e.textChunkId||"",Q.value.questions=e.outline&&e.outline.length>0?[...e.outline]:[""],Q.value.answer=e.textChunk||"",Q.value.description=e.description||"",j.value&&j.value.clearValidate()}});const F=C,Q=r({id:"",questions:[""],answer:"",description:"",tags:[]}),A={questions:[{validator:(a,l,s)=>{const o=(l||[]).map((e=>`${e||""}`.trim()));o.length&&!o.some((e=>!e))?s():s(new Error(e("common.input.required")))},trigger:"blur"}],answer:[{required:!0,message:e("common.input.required"),trigger:"blur"}]},I=()=>{Q.value.questions.push("")};const $=async()=>{j.value&&await j.value.validate((async l=>{if(l){U.value=!0,F("loading-change",!0);try{const l=Q.value.questions.map((e=>`${e||""}`.trim())).filter(Boolean),s=[{id:Q.value.id||void 0,outline:l,textChunk:Q.value.answer,description:Q.value.description}];await a(s),u.success(e("common.success")),F("add-success")}catch(s){u.error(e("common.fail"))}finally{U.value=!1,F("loading-change",!1)}}}))};return(a,l)=>{const u=d("loading");return c(),m("div",x,[p((c(),v(h(n),{ref_key:"qaFormRef",ref:j,model:Q.value,rules:A,"label-width":"100px",class:"qa-form"},{default:f((()=>[b(h(s),{label:h(e)("kb.question"),prop:"questions"},{default:f((()=>[q("div",y,[(c(!0),m(g,null,_(Q.value.questions,((a,l)=>(c(),m("div",{key:l,class:"question-item"},[b(h(o),{modelValue:Q.value.questions[l],"onUpdate:modelValue":e=>Q.value.questions[l]=e,placeholder:h(e)("common.placeholder")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),b(h(t),{type:"danger",text:"",disabled:1===Q.value.questions.length,onClick:e=>(e=>{1!==Q.value.questions.length&&Q.value.questions.splice(e,1)})(l)},{default:f((()=>[w(k(h(e)("common.delete")),1)])),_:1},8,["disabled","onClick"])])))),128)),b(h(t),{type:"primary",text:"",onClick:I},{default:f((()=>[w(k(h(e)("common.add")),1)])),_:1})])])),_:1},8,["label"]),b(h(s),{label:h(e)("kb.answer"),prop:"answer"},{default:f((()=>[b(h(o),{modelValue:Q.value.answer,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.value.answer=e),placeholder:h(e)("common.placeholder"),type:"textarea",rows:6},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),b(h(s),{label:h(e)("kb.description")},{default:f((()=>[b(h(o),{modelValue:Q.value.description,"onUpdate:modelValue":l[1]||(l[1]=e=>Q.value.description=e),placeholder:h(e)("common.placeholder")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),b(h(s),null,{default:f((()=>[q("div",V,[b(h(t),{type:"primary",onClick:$},{default:f((()=>[w(k(h(e)("common.submit")),1)])),_:1})])])),_:1})])),_:1},8,["model"])),[[u,U.value]])])}}}),[["__scopeId","data-v-4963b390"]]);export{C as Q};
