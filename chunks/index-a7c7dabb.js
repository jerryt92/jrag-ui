import{h as e,t as l}from"../index-c9af1b46.js";import{T as a}from"./topoBar-9475b172.js";import{g as o,p as t}from"./oem-517c1d66.js";import{_ as s}from"./plugin-vue_export-helper-3b0dab4c.js";import{x as n,g as m,c as i,y as u,A as d,B as p,u as r,d as v,f as c,C as g,a as b,i as V}from"./element-plus-82bb4bf2.js";import{d as y,r as _,f,aa as A,o as E,c as h,X as N,U,a as x,Q as R,u as C,M as T,a4 as K}from"./@vue-bb747027.js";import"./vue-router-6370cc0f.js";import"./axios-ff411c8f.js";import"./mitt-106818fe.js";import"./lodash-es-99da8f02.js";import"./@popperjs-66964824.js";import"./@vueuse-09ca9f25.js";import"./@element-plus-ccefd8d4.js";import"./async-validator-b6f94fc9.js";import"./@ctrl-d2fe7c9e.js";import"./normalize-wheel-es-233dc293.js";const M={class:"settings-page"},B={class:"settings-content"},S={class:"settings-header"},P={class:"section-title"},I={class:"section-title"},k={class:"section-desc"},w={class:"section-title"},j={class:"section-desc"},O={class:"settings-actions"},L={class:"section-title"},X={class:"section-title"},$={class:"section-desc"},q={class:"section-title"},J={class:"section-desc"},Y={class:"settings-actions"},z={class:"settings-actions"};var F=s(y({__name:"index",setup(s){const y=_("llm"),F=_(!1),Q=_(!1),D=_({provider:"open-ai",useRag:!0,useTools:!0,temperature:0,ollamaModelName:"qwen3:14b-q8_0",ollamaBaseUrl:"http://172.16.8.107:11434",ollamaKeepAliveSeconds:3600,ollamaContextLength:32768,openAiModelName:"qwen-plus",openAiBaseUrl:"https://dashscope.aliyuncs.com",openAiCompletionsPath:"/compatible-mode/v1/chat/completions",openAiKey:"",openAiContextLength:32768}),G=_({provider:"open-ai",ollamaModelName:"nomic-embed-text:latest",ollamaBaseUrl:"http://127.0.0.1:11434",ollamaKeepAliveSeconds:3600,openAiModelName:"text-embedding-v4",openAiBaseUrl:"https://dashscope.aliyuncs.com",openAiEmbeddingsPath:"/compatible-mode/v1/embeddings",openAiKey:""}),H=_(""),W=_({topK:5,metricType:"COSINE",metricScoreExpr:"> 0.7"}),Z=(e,l=!1)=>null==e?l:"1"===e.trim()||"true"===e.trim().toLowerCase(),ee=(e,l)=>{if(null==e)return l;const a=Number(e);return Number.isFinite(a)?a:l},le=async()=>{F.value=!0;try{const l=["llm-provider","llm-use-rag","llm-use-tools","llm-temperature","llm-ollama-model-name","llm-ollama-base-url","llm-ollama-keep-alive-seconds","llm-ollama-context-length","llm-open-ai-model-name","llm-open-ai-base-url","llm-open-ai-completions-path","llm-open-ai-key","llm-open-ai-context-length","embedding-provider","embedding-ollama-model-name","embedding-ollama-base-url","embedding-ollama-keep_alive_seconds","embedding-open-ai-model-name","embedding-open-ai-base-url","embedding-open-ai-embeddings-path","embedding-open-ai-key","RETRIEVE_TOP_K","RETRIEVE_METRIC_TYPE","RETRIEVE_METRIC_SCORE_COMPARE_EXPR"],s=(e=>e?.data?.data?e.data.data:e?.data??{})(await(a=l,e.post(`/v1${o}rest/${t}/property/get`,a)));D.value.provider=s["llm-provider"]||D.value.provider,D.value.useRag=Z(s["llm-use-rag"],D.value.useRag),D.value.useTools=Z(s["llm-use-tools"],D.value.useTools),D.value.temperature=ee(s["llm-temperature"],D.value.temperature),D.value.ollamaModelName=s["llm-ollama-model-name"]||D.value.ollamaModelName,D.value.ollamaBaseUrl=s["llm-ollama-base-url"]||D.value.ollamaBaseUrl,D.value.ollamaKeepAliveSeconds=ee(s["llm-ollama-keep-alive-seconds"],D.value.ollamaKeepAliveSeconds),D.value.ollamaContextLength=ee(s["llm-ollama-context-length"],D.value.ollamaContextLength),D.value.openAiModelName=s["llm-open-ai-model-name"]||D.value.openAiModelName,D.value.openAiBaseUrl=s["llm-open-ai-base-url"]||D.value.openAiBaseUrl,D.value.openAiCompletionsPath=s["llm-open-ai-completions-path"]||D.value.openAiCompletionsPath,D.value.openAiKey=s["llm-open-ai-key"]||D.value.openAiKey,D.value.openAiContextLength=ee(s["llm-open-ai-context-length"],D.value.openAiContextLength),G.value.provider=s["embedding-provider"]||G.value.provider,G.value.ollamaModelName=s["embedding-ollama-model-name"]||G.value.ollamaModelName,G.value.ollamaBaseUrl=s["embedding-ollama-base-url"]||G.value.ollamaBaseUrl,G.value.ollamaKeepAliveSeconds=ee(s["embedding-ollama-keep_alive_seconds"],G.value.ollamaKeepAliveSeconds),G.value.openAiModelName=s["embedding-open-ai-model-name"]||G.value.openAiModelName,G.value.openAiBaseUrl=s["embedding-open-ai-base-url"]||G.value.openAiBaseUrl,G.value.openAiEmbeddingsPath=s["embedding-open-ai-embeddings-path"]||G.value.openAiEmbeddingsPath,G.value.openAiKey=s["embedding-open-ai-key"]||G.value.openAiKey,H.value=JSON.stringify(G.value),W.value.topK=ee("RETRIEVE_TOP_K"in s?s.RETRIEVE_TOP_K:void 0,W.value.topK),W.value.metricType=s.RETRIEVE_METRIC_TYPE||W.value.metricType,W.value.metricScoreExpr=s.RETRIEVE_METRIC_SCORE_COMPARE_EXPR||W.value.metricScoreExpr}catch(s){b.error(l("settings.load.failed"))}finally{F.value=!1}var a},ae=async()=>{Q.value=!0;try{H.value!==JSON.stringify(G.value)&&await(async()=>{await V.confirm(l("settings.embedding.rebuild.confirm"),l("settings.embedding.rebuild.title"),{confirmButtonText:l("settings.embedding.rebuild.confirm.ok"),cancelButtonText:l("settings.embedding.rebuild.confirm.cancel"),type:"warning"})})(),await(a=(()=>{const e=e=>null==e?"":String(e);return[{propertyName:"llm-provider",propertyValue:e(D.value.provider)},{propertyName:"llm-use-rag",propertyValue:e(D.value.useRag)},{propertyName:"llm-use-tools",propertyValue:e(D.value.useTools)},{propertyName:"llm-temperature",propertyValue:e(D.value.temperature)},{propertyName:"llm-ollama-model-name",propertyValue:e(D.value.ollamaModelName)},{propertyName:"llm-ollama-base-url",propertyValue:e(D.value.ollamaBaseUrl)},{propertyName:"llm-ollama-keep-alive-seconds",propertyValue:e(D.value.ollamaKeepAliveSeconds)},{propertyName:"llm-ollama-context-length",propertyValue:e(D.value.ollamaContextLength)},{propertyName:"llm-open-ai-model-name",propertyValue:e(D.value.openAiModelName)},{propertyName:"llm-open-ai-base-url",propertyValue:e(D.value.openAiBaseUrl)},{propertyName:"llm-open-ai-completions-path",propertyValue:e(D.value.openAiCompletionsPath)},{propertyName:"llm-open-ai-key",propertyValue:e(D.value.openAiKey)},{propertyName:"llm-open-ai-context-length",propertyValue:e(D.value.openAiContextLength)},{propertyName:"embedding-provider",propertyValue:e(G.value.provider)},{propertyName:"embedding-ollama-model-name",propertyValue:e(G.value.ollamaModelName)},{propertyName:"embedding-ollama-base-url",propertyValue:e(G.value.ollamaBaseUrl)},{propertyName:"embedding-ollama-keep_alive_seconds",propertyValue:e(G.value.ollamaKeepAliveSeconds)},{propertyName:"embedding-open-ai-model-name",propertyValue:e(G.value.openAiModelName)},{propertyName:"embedding-open-ai-base-url",propertyValue:e(G.value.openAiBaseUrl)},{propertyName:"embedding-open-ai-embeddings-path",propertyValue:e(G.value.openAiEmbeddingsPath)},{propertyName:"embedding-open-ai-key",propertyValue:e(G.value.openAiKey)},{propertyName:"RETRIEVE_TOP_K",propertyValue:e(W.value.topK)},{propertyName:"RETRIEVE_METRIC_TYPE",propertyValue:e(W.value.metricType)},{propertyName:"RETRIEVE_METRIC_SCORE_COMPARE_EXPR",propertyValue:e(W.value.metricScoreExpr)}]})(),e.put(`/v1${o}rest/${t}/property`,a)),H.value=JSON.stringify(G.value),b.success(l("settings.save.success"))}catch(s){"cancel"!==s&&b.error(l("settings.save.failed"))}finally{Q.value=!1}var a};return f((()=>{le()})),(e,o)=>{const t=A("loading");return E(),h("div",M,[N(a),U((E(),h("div",B,[x("div",S,[x("h2",null,R(C(l)("settings.title")),1)]),N(C(g),{modelValue:y.value,"onUpdate:modelValue":o[24]||(o[24]=e=>y.value=e),class:"settings-tabs"},{default:T((()=>[N(C(n),{label:C(l)("settings.llm.section"),name:"llm"},{default:T((()=>[N(C(m),{model:D.value,"label-width":"180px"},{default:T((()=>[x("div",P,R(C(l)("settings.basic.section")),1),N(C(i),{label:C(l)("settings.provider")},{default:T((()=>[N(C(u),{modelValue:D.value.provider,"onUpdate:modelValue":o[0]||(o[0]=e=>D.value.provider=e),class:"settings-select"},{default:T((()=>[N(C(d),{label:C(l)("settings.provider.openai"),value:"open-ai"},null,8,["label"]),N(C(d),{label:C(l)("settings.provider.ollama"),value:"ollama"},null,8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.use.rag")},{default:T((()=>[N(C(p),{modelValue:D.value.useRag,"onUpdate:modelValue":o[1]||(o[1]=e=>D.value.useRag=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.use.tools")},{default:T((()=>[N(C(p),{modelValue:D.value.useTools,"onUpdate:modelValue":o[2]||(o[2]=e=>D.value.useTools=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.temperature")},{default:T((()=>[N(C(r),{modelValue:D.value.temperature,"onUpdate:modelValue":o[3]||(o[3]=e=>D.value.temperature=e),min:0,max:2,step:.1},null,8,["modelValue"])])),_:1},8,["label"]),x("div",I,R(C(l)("settings.ollama.section")),1),x("div",k,R(C(l)("settings.ollama.desc")),1),N(C(i),{label:C(l)("settings.model.name")},{default:T((()=>[N(C(v),{modelValue:D.value.ollamaModelName,"onUpdate:modelValue":o[4]||(o[4]=e=>D.value.ollamaModelName=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.base.url")},{default:T((()=>[N(C(v),{modelValue:D.value.ollamaBaseUrl,"onUpdate:modelValue":o[5]||(o[5]=e=>D.value.ollamaBaseUrl=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.keep.alive.seconds")},{default:T((()=>[N(C(r),{modelValue:D.value.ollamaKeepAliveSeconds,"onUpdate:modelValue":o[6]||(o[6]=e=>D.value.ollamaKeepAliveSeconds=e),min:1},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.context.length")},{default:T((()=>[N(C(r),{modelValue:D.value.ollamaContextLength,"onUpdate:modelValue":o[7]||(o[7]=e=>D.value.ollamaContextLength=e),min:1},null,8,["modelValue"])])),_:1},8,["label"]),x("div",w,R(C(l)("settings.openai.section")),1),x("div",j,R(C(l)("settings.openai.desc")),1),N(C(i),{label:C(l)("settings.model.name")},{default:T((()=>[N(C(v),{modelValue:D.value.openAiModelName,"onUpdate:modelValue":o[8]||(o[8]=e=>D.value.openAiModelName=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.base.url")},{default:T((()=>[N(C(v),{modelValue:D.value.openAiBaseUrl,"onUpdate:modelValue":o[9]||(o[9]=e=>D.value.openAiBaseUrl=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.completions.path")},{default:T((()=>[N(C(v),{modelValue:D.value.openAiCompletionsPath,"onUpdate:modelValue":o[10]||(o[10]=e=>D.value.openAiCompletionsPath=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.api.key")},{default:T((()=>[N(C(v),{modelValue:D.value.openAiKey,"onUpdate:modelValue":o[11]||(o[11]=e=>D.value.openAiKey=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.context.length")},{default:T((()=>[N(C(r),{modelValue:D.value.openAiContextLength,"onUpdate:modelValue":o[12]||(o[12]=e=>D.value.openAiContextLength=e),min:1},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model"]),x("div",O,[N(C(c),{type:"primary",loading:Q.value,onClick:ae},{default:T((()=>[K(R(C(l)("settings.save")),1)])),_:1},8,["loading"])])])),_:1},8,["label"]),N(C(n),{label:C(l)("settings.embedding.section"),name:"embedding"},{default:T((()=>[N(C(m),{model:G.value,"label-width":"180px"},{default:T((()=>[x("div",L,R(C(l)("settings.basic.section")),1),N(C(i),{label:C(l)("settings.provider")},{default:T((()=>[N(C(u),{modelValue:G.value.provider,"onUpdate:modelValue":o[13]||(o[13]=e=>G.value.provider=e),class:"settings-select"},{default:T((()=>[N(C(d),{label:C(l)("settings.provider.openai"),value:"open-ai"},null,8,["label"]),N(C(d),{label:C(l)("settings.provider.ollama"),value:"ollama"},null,8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"]),x("div",X,R(C(l)("settings.ollama.section")),1),x("div",$,R(C(l)("settings.ollama.desc")),1),N(C(i),{label:C(l)("settings.model.name")},{default:T((()=>[N(C(v),{modelValue:G.value.ollamaModelName,"onUpdate:modelValue":o[14]||(o[14]=e=>G.value.ollamaModelName=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.base.url")},{default:T((()=>[N(C(v),{modelValue:G.value.ollamaBaseUrl,"onUpdate:modelValue":o[15]||(o[15]=e=>G.value.ollamaBaseUrl=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.keep.alive.seconds")},{default:T((()=>[N(C(r),{modelValue:G.value.ollamaKeepAliveSeconds,"onUpdate:modelValue":o[16]||(o[16]=e=>G.value.ollamaKeepAliveSeconds=e),min:1},null,8,["modelValue"])])),_:1},8,["label"]),x("div",q,R(C(l)("settings.openai.section")),1),x("div",J,R(C(l)("settings.openai.desc")),1),N(C(i),{label:C(l)("settings.model.name")},{default:T((()=>[N(C(v),{modelValue:G.value.openAiModelName,"onUpdate:modelValue":o[17]||(o[17]=e=>G.value.openAiModelName=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.base.url")},{default:T((()=>[N(C(v),{modelValue:G.value.openAiBaseUrl,"onUpdate:modelValue":o[18]||(o[18]=e=>G.value.openAiBaseUrl=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.embeddings.path")},{default:T((()=>[N(C(v),{modelValue:G.value.openAiEmbeddingsPath,"onUpdate:modelValue":o[19]||(o[19]=e=>G.value.openAiEmbeddingsPath=e)},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.api.key")},{default:T((()=>[N(C(v),{modelValue:G.value.openAiKey,"onUpdate:modelValue":o[20]||(o[20]=e=>G.value.openAiKey=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model"]),x("div",Y,[N(C(c),{type:"primary",loading:Q.value,onClick:ae},{default:T((()=>[K(R(C(l)("settings.save")),1)])),_:1},8,["loading"])])])),_:1},8,["label"]),N(C(n),{label:C(l)("settings.rag.section"),name:"rag"},{default:T((()=>[N(C(m),{model:W.value,"label-width":"220px"},{default:T((()=>[N(C(i),{label:C(l)("settings.rag.topk")},{default:T((()=>[N(C(r),{modelValue:W.value.topK,"onUpdate:modelValue":o[21]||(o[21]=e=>W.value.topK=e),min:1},null,8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.rag.metric.type")},{default:T((()=>[N(C(u),{modelValue:W.value.metricType,"onUpdate:modelValue":o[22]||(o[22]=e=>W.value.metricType=e),class:"settings-select"},{default:T((()=>[N(C(d),{label:"COSINE",value:"COSINE"}),N(C(d),{label:"IP",value:"IP"}),N(C(d),{label:"L2",value:"L2"})])),_:1},8,["modelValue"])])),_:1},8,["label"]),N(C(i),{label:C(l)("settings.rag.metric.score.expr")},{default:T((()=>[N(C(v),{modelValue:W.value.metricScoreExpr,"onUpdate:modelValue":o[23]||(o[23]=e=>W.value.metricScoreExpr=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model"]),x("div",z,[N(C(c),{type:"primary",loading:Q.value,onClick:ae},{default:T((()=>[K(R(C(l)("settings.save")),1)])),_:1},8,["loading"])])])),_:1},8,["label"])])),_:1},8,["modelValue"])])),[[t,F.value]])])}}}),[["__scopeId","data-v-2d0e6cda"]]);export{F as default};
