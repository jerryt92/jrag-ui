!function(){function a(a){return function(a){if(Array.isArray(a))return e(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||function(a,t){if(a){if("string"==typeof a)return e(a,t);var n={}.toString.call(a).slice(8,-1);return"Object"===n&&a.constructor&&(n=a.constructor.name),"Map"===n||"Set"===n?Array.from(a):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(a,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(a,e){(null==e||e>a.length)&&(e=a.length);for(var t=0,n=Array(e);t<e;t++)n[t]=a[t];return n}var t=document.createElement("style");t.innerHTML=".chat-manage-container[data-v-c5432ace]{width:400px;padding:70px 20px 20px;margin:auto;display:flex;height:100%;justify-content:center}.chat-manage-container .iconfont[data-v-c5432ace]{margin-right:5px}.chat-manage-container .chat-manage-card[data-v-c5432ace]{background:color-mix(in srgb,var(--n-color-neutral-w),transparent 90%);backdrop-filter:blur(10px);border-radius:var(--n-radius-quadruple);border:1px solid color-mix(in srgb,var(--n-color-neutral-4),transparent 50%);box-shadow:0 8px 32px rgba(31,38,135,.1);display:flex;flex-direction:column;align-items:center;height:100%;flex-grow:1;padding:0 20px 20px;position:relative;left:0;width:100%;max-width:360px}.chat-manage-container .chat-manage-header[data-v-c5432ace]{text-align:center;display:flex;flex-direction:row;justify-content:center;align-items:center;padding:20px 0;width:320px}.chat-manage-container .chat-manage-header .el-button[data-v-c5432ace]{height:40px}.chat-manage-container .chat-manage-header .el-button.add[data-v-c5432ace]{width:270px}.chat-manage-container .chat-manage-header .el-button.is-circle[data-v-c5432ace]{flex:1;width:40px;margin-left:10px}.chat-manage-container .chat-manage-header .search-button[data-v-c5432ace]{background-color:var(--n-color-neutral-w)}.chat-manage-container .chat-manage-header .el-input.search-input[data-v-c5432ace]{height:40px;width:100%}.chat-manage-container .chat-manage-header .el-input.search-input[data-v-c5432ace] .el-input__wrapper{background-color:var(--n-color-neutral-w);border-radius:40px}.chat-manage-container .chat-list[data-v-c5432ace]{padding:10px 0 0;display:flex;flex-direction:column;justify-content:center;align-items:center;flex-grow:1;width:320px;overflow:auto}.chat-manage-container .chat-list .text[data-v-c5432ace]{color:var(--n-color-font-dark)}.chat-manage-container .chat-list .list-title[data-v-c5432ace]{justify-content:space-between;width:100%;margin-bottom:5px;padding-right:10px}.chat-manage-container .chat-list .list-title .delete[data-v-c5432ace]{color:var(--el-color-info);cursor:pointer}.chat-manage-container .chat-list .list-title .delete[data-v-c5432ace]:hover{color:var(--el-color-primary)}.chat-manage-container .chat-list .list-content[data-v-c5432ace]{width:100%;height:100%;overflow:auto;padding-right:10px}.chat-manage-container .chat-list .list-content .list-item[data-v-c5432ace]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:95%;margin:15px auto auto;padding:0 15px;background-color:rgba(255,255,255,.8);border-radius:15px;height:45px;line-height:45px;cursor:pointer}.chat-manage-container .chat-list .list-content .list-item[data-v-c5432ace]:hover,.chat-manage-container .chat-list .list-content .list-item.active[data-v-c5432ace]{color:var(--el-color-primary);box-shadow:0 0 12px var(--el-color-primary-light-3)}.chat-manage-container .chat-list .list-content .list-item .cont[data-v-c5432ace]{width:calc(100% - 20px);flex-grow:1}.chat-manage-container .chat-list .list-content .list-item .cont p[data-v-c5432ace]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chat-manage-container .chat-list .list-content .list-item .el-dropdown[data-v-c5432ace]{z-index:999;width:20px;padding-left:10px}.chat-manage-container .chat-list .list-content .list-item .icon-vgengduo[data-v-c5432ace]:hover{color:var(--el-color-primary)}.chat-manage-container .chat-list .list-content .el-dropdown-link[data-v-c5432ace]{display:flex;align-items:center}.chat-container[data-v-333f0a54]{height:100%;display:flex;flex-direction:column;position:relative}.chat-container.fullscreen[data-v-333f0a54]{flex-direction:row}.chat-container.fullscreen .chat-manage-view[data-v-333f0a54]{width:360px;max-width:360px;height:100%}.chat-container.fullscreen .chat-manage-view[data-v-333f0a54] .chat-list{height:100%!important;max-height:100%!important}.chat-container.fullscreen .chat-view[data-v-333f0a54]{flex-grow:1;width:100%}.chat-container .chat-view[data-v-333f0a54]{display:flex;flex-direction:column;justify-content:center;height:100%;padding:calc(2 * var(--n-padding-basic))}.chat-container .chat-view .scroll[data-v-333f0a54]{flex-grow:1;height:100%}.ai-logo[data-v-333f0a54]{width:100px;margin:0 auto}.ai-logo img[data-v-333f0a54]{width:100%;height:100%;object-fit:contain}.message-init[data-v-333f0a54]{text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:60px;padding:20px 0}.message-init .title[data-v-333f0a54]{font-size:20px;color:var(--n-color-font-dark);margin-top:20px}.message-init .sub-tip[data-v-333f0a54]{font-size:18px;color:#637a9e;line-height:1.5;display:block;margin:20px 0 30px}.message-init .hot-questions[data-v-333f0a54]{display:flex;margin-top:20px;flex-direction:column;background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);border-radius:var(--n-radius-quadruple);border:1px solid color-mix(in srgb,var(--n-color-neutral-4),transparent 50%);box-shadow:0 8px 32px rgba(31,38,135,.1);color:var(--n-color-font-dark);min-width:350px;max-width:450px;padding:20px;max-height:300px;min-height:160px;overflow:auto}.message-init .hot-questions .hot-questions-title[data-v-333f0a54]{justify-content:space-between;margin-bottom:15px}.message-init .hot-questions .hot-questions-title strong .el-icon[data-v-333f0a54]{margin-right:2px}.message-init .hot-questions .hot-questions-title .change[data-v-333f0a54]{cursor:pointer;display:flex;justify-content:center;align-items:center}.message-init .hot-questions .hot-questions-title .change[data-v-333f0a54]:hover{color:var(--el-color-primary)}.message-init .hot-questions .question-list[data-v-333f0a54]{flex-direction:column;justify-content:center}.message-init .hot-questions .question-list .question[data-v-333f0a54]{display:flex;margin-bottom:15px;cursor:pointer;line-height:1.5;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.message-init .hot-questions .question-list .question[data-v-333f0a54]:hover{color:var(--el-color-primary)}.message-init .hot-questions .question-list .question .qa[data-v-333f0a54]{margin-right:10px;height:20px;line-height:20px;color:var(--el-color-primary);font-style:italic;background-color:var(--el-color-primary-light-9);display:inline-block;padding:0 4px;border-radius:15px}.message-init .hot-questions .question-list .question[data-v-333f0a54]:last-child{margin-bottom:0}.message-list[data-v-333f0a54]{padding:20px 0}.message-list .message-row[data-v-333f0a54]{margin-bottom:20px;display:flex}.message-list .message-row .message-content[data-v-333f0a54]{max-width:80%;padding:10px 15px;border-radius:15px;height:100%;min-height:48px;font-size:var(--n-font-size-2);word-wrap:break-word;word-break:break-all;justify-content:center;display:flex;flex-direction:column;transition:transform .2s ease}.message-list .message-row .message-content[data-v-333f0a54]:hover{transform:translate(-3px,-3px);box-shadow:0 6px 8px rgba(0,0,0,.1)}.message-list .message-row .message-content[data-v-333f0a54] img{max-width:100%;height:auto;display:block}.message-list .message-row.assistant .message-content[data-v-333f0a54]{background-color:var(--el-color-primary-light-8);border:1px solid var(--el-color-primary-light-8)}.message-list .message-row.assistant .message-content .src-file[data-v-333f0a54]{margin-top:15px;font-style:italic;font-size:var(--n-font-size-1)}.message-list .message-row.assistant .message-content .support[data-v-333f0a54]{text-align:right;margin-top:10px}.message-list .message-row.assistant .message-content .support .feedback-icon-good[data-v-333f0a54]{cursor:pointer}.message-list .message-row.assistant .message-content .support .feedback-icon-good[data-v-333f0a54]:last-child{margin-right:0}.message-list .message-row.assistant .message-content .support .feedback-icon-good[data-v-333f0a54]:hover,.message-list .message-row.assistant .message-content .support .feedback-icon-good.good[data-v-333f0a54]{text-shadow:0px 0px 10px var(--el-color-success)}.message-list .message-row.assistant .message-content .support .feedback-icon-bad[data-v-333f0a54]{cursor:pointer}.message-list .message-row.assistant .message-content .support .feedback-icon-bad[data-v-333f0a54]:last-child{margin-right:0}.message-list .message-row.assistant .message-content .support .feedback-icon-bad[data-v-333f0a54]:hover,.message-list .message-row.assistant .message-content .support .feedback-icon-bad.bad[data-v-333f0a54]{text-shadow:0px 0px 10px var(--el-color-error)}.message-list .message-row.user[data-v-333f0a54]{justify-content:flex-end}.message-list .message-row.user .message-content[data-v-333f0a54]{background-color:#d8d8f6}.input-area[data-v-333f0a54]{overflow:visible;display:flex;padding:0;border-radius:15px;position:relative}.input-area .el-textarea.chat-input[data-v-333f0a54] .el-input__count{right:60px;bottom:16px;background:rgba(255,255,255,0)}.input-area .el-textarea.chat-input[data-v-333f0a54] .el-textarea__inner{resize:none;background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);padding:15px 20px;border-color:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);border-radius:15px;word-wrap:break-word;word-break:break-all;box-shadow:none}.input-area .el-textarea.chat-input[data-v-333f0a54] :hover{box-shadow:0 0 12px color-mix(in srgb,var(--el-color-primary-light-3),transparent 10%)}.input-area .el-button[data-v-333f0a54]{position:absolute;right:20px;bottom:15px}.thinking-indicator[data-v-333f0a54]{margin-top:14px;margin-right:10px;display:inline-block;width:20px;height:20px;border:3px solid var(--el-color-primary-light-8);border-top-color:var(--el-color-primary);border-radius:50%;animation:thinking-333f0a54 1s linear infinite;margin-left:10px;flex-shrink:0}.avatar-wrap[data-v-333f0a54]{margin:0 10px}.avatar-wrap .el-avatar[data-v-333f0a54]{margin:0;flex-shrink:0;width:50px;height:50px}.avatar-wrap .ai-chat-logo[data-v-333f0a54]{background-color:#7eaaff}.avatar-wrap .ai-chat-logo img[data-v-333f0a54]{width:100%;height:100%;object-fit:contain}.avatar-wrap.thinking-avatar[data-v-333f0a54]{width:50px;height:50px;box-shadow:0 0 12px var(--el-color-primary);background:linear-gradient(#9724ff,#00c4ff);border-radius:50%;justify-content:center;display:flex;align-items:center;animation:thinking-333f0a54 1s linear infinite}.avatar-wrap.thinking-avatar .el-avatar[data-v-333f0a54]{width:42px;height:42px;animation:anti-thinking-333f0a54 1s linear infinite}.avatar-wrap.thinking-avatar .ai-chat-logo[data-v-333f0a54]{padding:7px 7px 10px}@keyframes thinking-333f0a54{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes anti-thinking-333f0a54{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}.message-content[data-v-333f0a54] h1{font-size:var(--n-font-size-6);margin-bottom:calc(var(--n-font-size-6) / 2)}.message-content[data-v-333f0a54] h2{font-size:var(--n-font-size-5);margin-bottom:calc(var(--n-font-size-5) / 2)}.message-content[data-v-333f0a54] h3{font-size:var(--n-font-size-4);margin-bottom:calc(var(--n-font-size-4) / 2)}.message-content[data-v-333f0a54] h4{font-size:var(--n-font-size-3);margin-bottom:calc(var(--n-font-size-3) / 2)}.message-content[data-v-333f0a54] h5{font-size:var(--n-font-size-2);margin-bottom:calc(var(--n-font-size-2) / 2)}.message-content[data-v-333f0a54] h6{font-size:var(--n-font-size-1);margin-bottom:calc(var(--n-font-size-1) / 2)}.message-content[data-v-333f0a54] ol{list-style:none;padding-left:calc(3 * var(--n-font-size-2))}.message-content[data-v-333f0a54] ol li{list-style:decimal}.message-content[data-v-333f0a54] ul{padding-left:calc(3 * var(--n-font-size-2))}.message-content[data-v-333f0a54] ul li{list-style:disc}.message-content[data-v-333f0a54] a{color:#2b6afd;text-decoration:none}.message-content[data-v-333f0a54] a:hover{text-decoration:underline}.message-content[data-v-333f0a54] code{background-color:#d4d4d4;padding:3px;border-radius:4px;font-family:Courier New,Courier,monospace;white-space:pre-wrap;word-wrap:break-word}.message-content[data-v-333f0a54] pre{background-color:#1e1e1e;color:#e0e0e0;padding:1em;margin:10px 0;border-radius:4px;overflow-x:auto;font-family:monospace}.message-content[data-v-333f0a54] pre code{background-color:transparent;padding:0}.scroll-to-bottom-button[data-v-333f0a54]{position:absolute;top:93%;left:50%;transform:translate(-50%,-50%);background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);border:1px solid rgba(255,255,255,.18);box-shadow:0 8px 32px rgba(31,38,135,.1);backdrop-filter:blur(2px);border-radius:50%;padding:13px;cursor:pointer;transition:all .3s ease}.scroll-to-bottom-button[data-v-333f0a54]:hover{background:color-mix(in srgb,var(--n-color-neutral-4),transparent 50%);backdrop-filter:blur(5px);box-shadow:0 8px 32px rgba(31,38,135,.2);transform:translate(-50%,-50%) scale(1.2)}@media only screen and (max-width: 768px){.message-init[data-v-333f0a54]{padding:0 0 20px}}@media only screen and (max-width: 600px){.chat-input[data-v-333f0a54]{height:70px!important}.chat-input[data-v-333f0a54] textarea{height:70px!important;min-height:70px!important}.message-init[data-v-333f0a54]{padding:0 0 20px}.message-init .ai-logo[data-v-333f0a54]{width:80px}.message-init .title[data-v-333f0a54]{font-size:18px}.message-init .sub-tip[data-v-333f0a54]{font-size:16px}}.ai-assistant-page[data-v-5d71127a]{height:100%}.ai-assistant-page .chat-view[data-v-5d71127a]{width:100%}.ai-assistant-page .top-bar[data-v-5d71127a]{position:fixed;top:0;left:0;right:0;height:50px;background:color-mix(in srgb,var(--n-color-neutral-w),transparent 80%);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.18);box-shadow:0 8px 32px rgba(31,38,135,.1);display:flex;align-items:center;justify-content:left;z-index:100}.ai-assistant-page .top-bar h3[data-v-5d71127a]{margin-left:20px;font-size:20px;font-weight:500;color:var(--n-color-font-dark);text-shadow:0 2px 4px rgba(0,0,0,.1)}.ai-assistant-page .top-bar .menu-button-box[data-v-5d71127a]{position:absolute;display:flex;right:0}.ai-assistant-page .top-bar .menu-button-box .menu-button[data-v-5d71127a]{font-size:24px;margin-right:5px;cursor:pointer;width:36px;height:36px;display:flex;align-items:center;justify-content:center;color:#666;border-radius:8px;transition:all .3s}.ai-assistant-page .top-bar .menu-button-box .menu-button[data-v-5d71127a]:hover{background-color:rgba(0,0,0,.05)}.ai-assistant-page .top-bar .menu-button-box .menu-button.active[data-v-5d71127a]{color:var(--el-color-primary);background-color:rgba(var(--el-color-primary-rgb),.1)}.ai-assistant-page .menu-card[data-v-5d71127a]{position:fixed;top:60px;right:10px;z-index:100}\n",document.head.appendChild(t),System.register(["./@vue-legacy-6668af3c.js","./@element-plus-legacy-edce2d2e.js","./markdown-it-legacy-c66ffae4.js","./ai.api-legacy-64667896.js","../index-legacy-73d31e4b.js","./plugin-vue_export-helper-legacy-1285489a.js","./element-plus-legacy-4f82de2d.js","./vue-router-legacy-50422e91.js","./menuCard-legacy-79c3f6ff.js","./lodash-es-legacy-0f78b4f1.js","./mdurl-legacy-efdb6c67.js","./uc.micro-legacy-1b4c5267.js","./entities-legacy-bc6178f2.js","./linkify-it-legacy-5eba450c.js","./punycode.js-legacy-3c684dfd.js","./sse.js-legacy-c6427e4c.js","./axios-legacy-ec40b469.js","./mitt-legacy-e809dc6d.js","./@vueuse-legacy-8e4b7021.js","./async-validator-legacy-9f2b928b.js","./@popperjs-legacy-f5ef238f.js","./normalize-wheel-es-legacy-2498f61f.js","./@ctrl-legacy-93ea6807.js"],(function(e){"use strict";var t,n,i,o,r,s,l,c,u,d,f,g,v,p,h,m,x,b,w,y,k,C,q,j,A,z,E,P,T,H,I,S,L,M,F,N,U,B,O,R,_,Q,G,W,J,V,X,Z,Y,D,K,$,aa,ea,ta;return{setters:[function(a){t=a.d,n=a.r,i=a.w,o=a.o,r=a.c,s=a.a,l=a.I,c=a.u,u=a.G,d=a.S,f=a.J,g=a.a2,v=a.M,p=a.Q,h=a.R,m=a.af,x=a.n,b=a.H,w=a.L,y=a.f,k=a.C,C=a.F,q=a.ae},function(a){j=a.o,A=a.p,z=a.r,E=a.e,P=a.q},function(a){T=a.M},function(a){H=a.g,I=a.d,S=a.c,L=a.a,M=a.o,F=a.s,N=a.b,U=a.e,B=a.f,O=a.h},function(a){R=a.t,_=a.l},function(a){Q=a._},function(a){G=a.d,W=a.f,J=a.b,V=a.i,X=a.j,Z=a.k,Y=a.l,D=a.m,K=a.n,$=a.o},function(a){aa=a.u},function(a){ea=a.M},function(a){ta=a.e},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){var na={class:"chat-manage-container"},ia={class:"chat-manage-card"},oa={class:"chat-manage-header"},ra={class:"chat-list"},sa={class:"list-title fx"},la={class:"text"},ca={class:"list-content"},ua=["onClick"],da=t({__name:"chatManage",props:{newChat:{type:Function,required:!0,default:function(){}},historyChat:{type:Function,required:!0,default:function(){}},currContextId:{type:String,default:""},messageContext:{type:Array,default:function(){return[]}}},emits:["showChatManage"],setup:function(a,e){var t=e.expose,y=e.emit,k=a,C=n(),q=n(!1),A=n(""),z=n([]),E=n([]),P=n(k.currContextId),T=y;i((function(){return k.currContextId}),(function(a){P.value=a}));var S=function(){var a;T("showChatManage",!1),null!==(a=k.messageContext)&&void 0!==a&&a.length?(P.value="",k.newChat(),L()):J({message:R("ai.already.latest.chat"),type:"success"})},L=function(){H().then((function(a){z.value=a.data.data,F(A.value,z.value)}))},M=function(a){var e=[];a?e.push(a):z.value.forEach((function(a){e.push(a.contextId)})),V.confirm(R("ai.delete.warning"),R(a?"ai.delete.chat.confirm":"ai.delete.all.chat.confirm"),{confirmButtonText:R("common.ok"),cancelButtonText:R("common.cancel"),type:"warning"}).then((function(){I(e).then((function(e){L(),a===P.value&&S()}))}))};i((function(){return A.value}),(function(a){F(a)}));var F=function(a,e){var t=new RegExp(a,"i"),n=e||z.value;E.value=n.filter((function(a){return t.test(a.title)}))};return t({getHistoryListData:L}),function(a,e){var t;return o(),r("div",na,[s("div",ia,[s("div",oa,[q.value?(o(),l(c(G),{key:0,ref_key:"searchInputRef",ref:C,modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=function(a){return A.value=a}),class:"search-input",placeholder:a.$t("ai.search.history.context"),"suffix-icon":c(j),autofocus:"",onBlur:e[1]||(e[1]=function(a){return q.value=!1})},null,8,["modelValue","placeholder","suffix-icon"])):(o(),r(u,{key:1},[d(c(W),{type:"primary",class:"add",round:"",onClick:S},{default:f((function(){return[e[4]||(e[4]=s("i",{class:"iconfont icon-chat-new"},null,-1)),g(v(a.$t("ai.add.new.chat")),1)]})),_:1}),d(c(W),{class:"search-button",icon:c(j),circle:"",onClick:e[2]||(e[2]=function(a){return q.value=!0,void x((function(){A.value="",C.value.focus()}))})},null,8,["icon"])],64))]),p(s("div",ra,[s("div",sa,[s("div",la,v(a.$t("ai.history.chat")),1),s("div",{class:"delete",onClick:e[3]||(e[3]=function(a){return M()})},[e[5]||(e[5]=s("i",{class:"iconfont icon-trash-alt"},null,-1)),g(v(a.$t("ai.delete.all.chat")),1)])]),s("div",ca,[(o(!0),r(u,null,m(E.value,(function(a,t){return o(),r("div",{key:t,class:b(["list-item fx",{active:P.value===a.contextId}])},[s("div",{class:"cont fx",style:{height:"100%"},onClick:function(e){return t=a.contextId,T("showChatManage",!1),P.value=t,k.historyChat(t),void(A.value="");var t}},[e[6]||(e[6]=s("i",{class:"iconfont icon-lishiduihua"},null,-1)),s("p",null,v(a.title),1)],8,ua),d(c(Y),{trigger:"hover",teleported:!1},{dropdown:f((function(){return[d(c(X),null,{default:f((function(){return[d(c(Z),{onClick:w((function(e){return M(a.contextId)}),["stop"])},{default:f((function(){return[e[7]||(e[7]=s("i",{class:"iconfont icon-trash-alt"},null,-1)),g(" "+v(c(R)("common.delete")),1)]})),_:1},8,["onClick"])]})),_:2},1024)]})),default:f((function(){return[e[8]||(e[8]=s("span",{class:"el-dropdown-link"},[s("span",{class:"iconfont icon-vgengduo"},"...")],-1))]})),_:2},1024)],2)})),128))])],512),[[h,null===(t=E.value)||void 0===t?void 0:t.length]])])])}}}),fa=Q(da,[["__scopeId","data-v-c5432ace"]]),ga=function(a){return a&&0!==a.length?a.map((function(a){return"- [".concat(a.fullFileName,"](").concat(a.url,")")})).join("\n"):""},va={key:0,class:"chat-view"},pa={class:"message-init"},ha={class:"title"},ma={class:"hot-questions"},xa={class:"fx hot-questions-title"},ba={class:"fx"},wa={class:"question-list"},ya=["onClick"],ka={key:0,class:"message-list"},Ca={class:"message-content"},qa=["innerHTML"],ja={class:"src-file"},Aa=["innerHTML"],za={class:"support"},Ea=["onClick"],Pa=["onClick"],Ta=["innerHTML"],Ha={class:"avatar-wrap"},Ia={class:"input-area"},Sa=t({__name:"ChatView",props:{isFullscreen:{type:Boolean,default:!1},isMobile:{type:Boolean,default:!1}},setup:function(e,t){var i=t.expose,l=new T({html:!0,linkify:!0,typographer:!0});l.renderer.rules.paragraph_open=function(a,e){return'<p style="line-height: var(--n-font-line-height-4);">'},l.renderer.rules.link_open=function(a,e,t,n,i){return a[e].attrPush(["target","_blank"]),i.renderToken(a,e,t)};var w,q,j=n(!1),H=n(null),I=n(),Q=n(),X=n(!0),Z=n([]),Y=n(""),aa=n(!1),ea=n(!0),ta=function(a){if(aa.value)J.info(R("ai.assistant.waiting"));else if(a&&(Y.value=a),Y.value.trim()){aa.value=!0,ia();var e={index:Z.value.length,content:Y.value,role:"user"};Z.value.push(e),Y.value="";var t={contextId:I.value,messages:Z.value};(q=L(t)).onopen=function(){w=M(I.value),ea.value&&(Z.value.push({index:Z.value.length,role:"assistant",content:""}),ea.value=!1),ia()},q.onmessage=function(a){try{var e=JSON.parse(a.data);na(e)}catch(t){}},q.onerror=function(a){401===a.responseCode?window.location.assign("/#/login"):0!==a.responseCode&&(J.error(R("ai.assistant.service.unavailable")),aa.value=!1,ea.value=!0)}}},na=function(a){var e,t;(oa(),X.value&&ia(),a.message)&&("system"===(null===(e=a.message)||void 0===e?void 0:e.role)?(Z.value[Z.value.length-1]=a.message,Z.value.push({index:Z.value.length,role:"assistant",content:""})):"assistant"===(null===(t=a.message)||void 0===t?void 0:t.role)&&(Z.value[Z.value.length-1].index,a.message.index,!0===a.done?(Z.value[Z.value.length-1].content+=a.message.content,aa.value=!1,ea.value=!0,x((function(){q.close(),w&&w.readyState===w.OPEN&&w.close()}))):(a.message.srcFile&&a.message.srcFile.length>0&&(Z.value[Z.value.length-1].srcFile=a.message.srcFile),a.message.content&&(Z.value[Z.value.length-1].content+=a.message.content))));F({contextId:I.value,messages:Z.value})},ia=function(){x((function(){Q.value&&Q.value.wrapRef.scrollTo({top:Q.value.wrapRef.scrollHeight,behavior:"smooth"})}))},oa=function(){if(Q.value){var a=Q.value.wrapRef,e=a.scrollTop,t=a.scrollHeight,n=a.clientHeight;X.value=e+100>t-n}},ra=!0,sa=function(a){"Enter"!==a.key||a.shiftKey||(ra=!0,a.preventDefault())},la=function(){ra=!1},ca=function(){ra&&(ra=!1,ta())},ua=n([]),da=function(){N().then((function(a){ua.value=a.data.data}))},Sa=function(a,e){e.feedback=a,O({contextId:I.value,index:e.index,feedback:a}).then((function(e){1===a&&J({message:"😊",type:"info"}),2===a&&J({message:"😭",type:"info"})}))},La=function(){Fa(),Y.value="",Z.value=[],X.value=!0,U().then((function(a){I.value=a.data.contextId})),da(),ia()},Ma=function(a){Fa(),Y.value="",a!==I.value&&H.value.getHistoryListData(),I.value=a,B(a).then((function(a){Z.value=a.data.messages,ia()}))},Fa=function(){aa.value=!1,ea.value=!0,q&&q.close(),w&&w.readyState===w.OPEN&&w.close()};return y((function(){S().then((function(a){2===a.status?V.alert(R("ai.api.key.invalid"),{type:"error",message:R("ai.api.key.invalid.desc"),callback:function(){}}):La()}))})),k((function(){Fa()})),i({showChatManage:j,chatManageRef:H,getHistoryListData:function(){return H.value.getHistoryListData()},newChat:La}),function(t,n){var i;return o(),r("div",{class:b(["chat-container",{fullscreen:e.isFullscreen,"is-mobile":e.isMobile}])},[p(d(fa,{class:"chat-manage",ref_key:"chatManageRef",ref:H,"new-chat":La,"history-chat":Ma,"curr-context-id":I.value,"message-context":Z.value,onShowChatManage:n[0]||(n[0]=function(a){return j.value=a})},null,8,["curr-context-id","message-context"]),[[h,j.value||e.isFullscreen]]),!j.value||e.isFullscreen||e.isMobile&&!j.value?(o(),r("div",va,[d(c(K),{ref_key:"scrollbarRef",ref:Q,class:"scroll",onScroll:oa},{default:f((function(){var e;return[s("div",pa,[n[4]||(n[4]=s("div",{class:"ai-logo"},[s("span",{style:{"font-size":"100px"}},"🤖")],-1)),s("h2",ha,v(t.$t("ai.hi.assistant")),1),s("div",ma,[s("div",xa,[s("strong",ba,[d(c(D),null,{default:f((function(){return[d(c(A))]})),_:1}),g(" "+v(t.$t("ai.hot.question")),1)]),s("span",{class:"change fx",onClick:da},[g(v(t.$t("ai.refresh.hot.question")),1),d(c(D),null,{default:f((function(){return[d(c(z))]})),_:1})])]),s("div",wa,[(o(!0),r(u,null,m(ua.value,(function(a,e){return o(),r("div",{key:e,class:"question",onClick:function(e){return t=a.question,void ta(t);var t}},[n[3]||(n[3]=s("strong",{class:"qa"},"HOT",-1)),g(v(a.question),1)],8,ya)})),128))])])]),null!==(e=Z.value)&&void 0!==e&&e.length?(o(),r("div",ka,[(o(!0),r(u,null,m(Z.value,(function(e,i){return o(),r("div",{key:i,class:b(["message-row",[e.role]])},["assistant"===e.role?(o(),r(u,{key:0},[s("div",{class:b(["avatar-wrap",[aa.value&&i===Z.value.length-1?"thinking-avatar":""]])},[d(c($),{size:50,class:"ai-chat-logo"},{default:f((function(){return a(n[5]||(n[5]=[s("span",{style:{"font-size":"30px",margin:"auto"}},"🤖",-1)]))})),_:1})],2),s("div",Ca,[s("div",{innerHTML:c(l).render(e.content+(aa.value&&i===Z.value.length-1?"...":""))},null,8,qa),p(s("div",ja,[n[6]||(n[6]=s("br",null,null,-1)),s("p",null,v(t.$t("ai.source")),1),s("div",{innerHTML:c(l).render(c(ga)(e.srcFile))},null,8,Aa)],512),[[h,e.srcFile&&e.srcFile.length>0]]),p(s("div",za,[s("span",{class:b(["feedback-icon-good",{good:1===e.feedback}]),onClick:function(a){return Sa(1,e)}},"👍",10,Ea),n[7]||(n[7]=g("   ",-1)),s("span",{class:b(["feedback-icon-bad",{bad:2===e.feedback}]),onClick:function(a){return Sa(2,e)}},"👎",10,Pa)],512),[[h,"user"===c(_)&&(null==e?void 0:e.content)&&!aa.value]])])],64)):"user"===e.role?(o(),r(u,{key:1},[s("div",{class:"message-content",innerHTML:c(l).render(e.content)},null,8,Ta),s("div",Ha,[d(c($),{size:50},{default:f((function(){return a(n[8]||(n[8]=[s("img",{src:"data:image/png;base64,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"},null,-1)]))})),_:1})])],64)):C("",!0)],2)})),128))])):C("",!0),X.value?C("",!0):(o(),r("div",{key:1,class:"scroll-to-bottom-button",onClick:ia},[d(c(D),null,{default:f((function(){return[d(c(E))]})),_:1})]))]})),_:1},512),s("div",Ia,[d(c(G),{modelValue:Y.value,"onUpdate:modelValue":n[1]||(n[1]=function(a){return Y.value=a}),class:"chat-input",placeholder:c(R)("ai.input.placeholder"),type:"textarea",autosize:{minRows:5,maxRows:10},maxlength:1e3,"show-word-limit":"",onKeydown:sa,onInput:la,onKeyup:ca},null,8,["modelValue","placeholder"]),d(c(W),{type:"primary",class:"chat-button",icon:c(P),circle:"",disabled:!(null!==(i=Y.value)&&void 0!==i&&i.length),onClick:n[2]||(n[2]=function(a){return ta()})},null,8,["icon","disabled"])])])):C("",!0)],2)}}}),La=Q(Sa,[["__scopeId","data-v-333f0a54"]]),Ma={class:"top-bar"},Fa={class:"menu-button-box"},Na=t({__name:"AIAssistantPage",setup:function(e){var t=aa(),i=n(null),l=n(null),c=n(!1),u=n(!0),f=n(!1),v=function(){i.value.showChatManage=!i.value.showChatManage,i.value.showChatManage&&x((function(){var a;null===(a=i.value.chatManageRef)||void 0===a||a.getHistoryListData()}))},m=function(){l.value.show()},w=function(){var a;(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<768||null!==(a=t.query)&&void 0!==a&&a.isMobile?(f.value=!0,u.value=!1,document.body.style.minWidth="0px"):(f.value=!1,u.value=!0,document.body.style.minWidth="768px")},C=function(){if(f.value){var a=document.querySelector(".web-app");a&&(a.style.height=window.innerHeight+"px")}else{var e=document.querySelector(".web-app");e&&(e.style.height="")}};return y((function(){w(),C(),f.value?C():x((function(){i.value.getHistoryListData()})),window.addEventListener("resize",ta((function(){w(),C()}),10)),window.addEventListener("orientationchange",(function(){setTimeout((function(){C()}),100)}))})),k((function(){window.removeEventListener("resize",w),window.removeEventListener("orientationchange",C)})),function(e,t){var n,x=q("draggable");return o(),r("div",{class:b(["ai-assistant-page",{"full-page":u.value,"mobile-page":f.value}])},[s("div",Ma,[t[3]||(t[3]=s("h3",null,"🤖 数据通信百科助手",-1)),s("div",Fa,[p((o(),r("span",{class:b(["menu-button",{active:null===(n=i.value)||void 0===n?void 0:n.showChatManage}]),onClick:v},a(t[1]||(t[1]=[g(" ⌥ ",-1)])),2)),[[h,f.value],[x,{device:"mobile"}]]),s("span",{class:b(["menu-button",{active:c.value}]),onClick:m},a(t[2]||(t[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-menu"},[s("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),s("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),s("line",{x1:"3",y1:"18",x2:"21",y2:"18"})],-1)])),2)])]),d(ea,{ref_key:"menuCardRef",ref:l,class:"menu-card",onShowChange:t[0]||(t[0]=function(a){return c.value=a})},null,512),d(La,{ref_key:"chatViewRef",ref:i,class:"chat-view","is-fullscreen":u.value,"is-mobile":f.value},null,8,["is-fullscreen","is-mobile"])],2)}}});e("default",Q(Na,[["__scopeId","data-v-5d71127a"]]))}}}))}();
